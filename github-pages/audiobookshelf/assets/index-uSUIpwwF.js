var Fr=Object.defineProperty;var Ir=(t,e,s)=>e in t?Fr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var me=(t,e,s)=>Ir(t,typeof e!="symbol"?e+"":e,s);import{r as b,a as Br,g as $r,R as pn,L as ae,u as ut,b as _r,c as mn,d as Dr,e as ge,N as Ht,B as Mr}from"./vendor-mfknaJCe.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();var gn={exports:{}},ht={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ur=b,Hr=Symbol.for("react.element"),zr=Symbol.for("react.fragment"),Vr=Object.prototype.hasOwnProperty,Kr=Ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wr={key:!0,ref:!0,__self:!0,__source:!0};function xn(t,e,s){var n,r={},o=null,a=null;s!==void 0&&(o=""+s),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Vr.call(e,n)&&!Wr.hasOwnProperty(n)&&(r[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:Hr,type:t,key:o,ref:a,props:r,_owner:Kr.current}}ht.Fragment=zr;ht.jsx=xn;ht.jsxs=xn;gn.exports=ht;var i=gn.exports,zt={},bs=Br;zt.createRoot=bs.createRoot,zt.hydrateRoot=bs.hydrateRoot;const qr={},vs=t=>{let e;const s=new Set,n=(u,h)=>{const v=typeof u=="function"?u(e):u;if(!Object.is(v,e)){const m=e;e=h??(typeof v!="object"||v===null)?v:Object.assign({},e,v),s.forEach(f=>f(e,m))}},r=()=>e,d={setState:n,getState:r,getInitialState:()=>c,subscribe:u=>(s.add(u),()=>s.delete(u)),destroy:()=>{(qr?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},c=e=t(n,r,d);return d},Jr=t=>t?vs(t):vs;var yn={exports:{}},bn={},vn={exports:{}},wn={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ce=b;function Gr(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Yr=typeof Object.is=="function"?Object.is:Gr,Qr=Ce.useState,Xr=Ce.useEffect,Zr=Ce.useLayoutEffect,eo=Ce.useDebugValue;function to(t,e){var s=e(),n=Qr({inst:{value:s,getSnapshot:e}}),r=n[0].inst,o=n[1];return Zr(function(){r.value=s,r.getSnapshot=e,Pt(r)&&o({inst:r})},[t,s,e]),Xr(function(){return Pt(r)&&o({inst:r}),t(function(){Pt(r)&&o({inst:r})})},[t]),eo(s),s}function Pt(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!Yr(t,s)}catch{return!0}}function so(t,e){return e()}var no=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?so:to;wn.useSyncExternalStore=Ce.useSyncExternalStore!==void 0?Ce.useSyncExternalStore:no;vn.exports=wn;var jn=vn.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ft=b,ro=jn;function oo(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var io=typeof Object.is=="function"?Object.is:oo,ao=ro.useSyncExternalStore,lo=ft.useRef,co=ft.useEffect,uo=ft.useMemo,ho=ft.useDebugValue;bn.useSyncExternalStoreWithSelector=function(t,e,s,n,r){var o=lo(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=uo(function(){function d(m){if(!c){if(c=!0,u=m,m=n(m),r!==void 0&&a.hasValue){var f=a.value;if(r(f,m))return h=f}return h=m}if(f=h,io(u,m))return f;var p=n(m);return r!==void 0&&r(f,p)?(u=m,f):(u=m,h=p)}var c=!1,u,h,v=s===void 0?null:s;return[function(){return d(e())},v===null?void 0:function(){return d(v())}]},[e,s,n,r]);var l=ao(t,o[0],o[1]);return co(function(){a.hasValue=!0,a.value=l},[l]),ho(l),l};yn.exports=bn;var fo=yn.exports;const po=$r(fo),Nn={},{useDebugValue:mo}=pn,{useSyncExternalStoreWithSelector:go}=po;let ws=!1;const xo=t=>t;function yo(t,e=xo,s){(Nn?"production":void 0)!=="production"&&s&&!ws&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ws=!0);const n=go(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,s);return mo(n),n}const bo=t=>{(Nn?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?Jr(t):t,s=(n,r)=>yo(e,n,r);return Object.assign(s,e),s},kn=t=>bo,vo={};function wo(t,e){let s;try{s=t()}catch{return}return{getItem:r=>{var o;const a=d=>d===null?null:JSON.parse(d,void 0),l=(o=s.getItem(r))!=null?o:null;return l instanceof Promise?l.then(a):a(l)},setItem:(r,o)=>s.setItem(r,JSON.stringify(o,void 0)),removeItem:r=>s.removeItem(r)}}const Me=t=>e=>{try{const s=t(e);return s instanceof Promise?s:{then(n){return Me(n)(s)},catch(n){return this}}}catch(s){return{then(n){return this},catch(n){return Me(n)(s)}}}},jo=(t,e)=>(s,n,r)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,N)=>({...N,...x}),...e},a=!1;const l=new Set,d=new Set;let c;try{c=o.getStorage()}catch{}if(!c)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),s(...x)},n,r);const u=Me(o.serialize),h=()=>{const x=o.partialize({...n()});let N;const j=u({state:x,version:o.version}).then(E=>c.setItem(o.name,E)).catch(E=>{N=E});if(N)throw N;return j},v=r.setState;r.setState=(x,N)=>{v(x,N),h()};const m=t((...x)=>{s(...x),h()},n,r);let f;const p=()=>{var x;if(!c)return;a=!1,l.forEach(j=>j(n()));const N=((x=o.onRehydrateStorage)==null?void 0:x.call(o,n()))||void 0;return Me(c.getItem.bind(c))(o.name).then(j=>{if(j)return o.deserialize(j)}).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==o.version){if(o.migrate)return o.migrate(j.state,j.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return j.state}).then(j=>{var E;return f=o.merge(j,(E=n())!=null?E:m),s(f,!0),h()}).then(()=>{N==null||N(f,void 0),a=!0,d.forEach(j=>j(f))}).catch(j=>{N==null||N(void 0,j)})};return r.persist={setOptions:x=>{o={...o,...x},x.getStorage&&(c=x.getStorage())},clearStorage:()=>{c==null||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>p(),hasHydrated:()=>a,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(d.add(x),()=>{d.delete(x)})},p(),f||m},No=(t,e)=>(s,n,r)=>{let o={storage:wo(()=>localStorage),partialize:p=>p,version:0,merge:(p,x)=>({...x,...p}),...e},a=!1;const l=new Set,d=new Set;let c=o.storage;if(!c)return t((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),s(...p)},n,r);const u=()=>{const p=o.partialize({...n()});return c.setItem(o.name,{state:p,version:o.version})},h=r.setState;r.setState=(p,x)=>{h(p,x),u()};const v=t((...p)=>{s(...p),u()},n,r);r.getInitialState=()=>v;let m;const f=()=>{var p,x;if(!c)return;a=!1,l.forEach(j=>{var E;return j((E=n())!=null?E:v)});const N=((x=o.onRehydrateStorage)==null?void 0:x.call(o,(p=n())!=null?p:v))||void 0;return Me(c.getItem.bind(c))(o.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==o.version){if(o.migrate)return[!0,o.migrate(j.state,j.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var E;const[T,F]=j;if(m=o.merge(F,(E=n())!=null?E:v),s(m,!0),T)return u()}).then(()=>{N==null||N(m,void 0),m=n(),a=!0,d.forEach(j=>j(m))}).catch(j=>{N==null||N(void 0,j)})};return r.persist={setOptions:p=>{o={...o,...p},p.storage&&(c=p.storage)},clearStorage:()=>{c==null||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>f(),hasHydrated:()=>a,onHydrate:p=>(l.add(p),()=>{l.delete(p)}),onFinishHydration:p=>(d.add(p),()=>{d.delete(p)})},o.skipHydration||f(),m||v},ko=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((vo?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),jo(t,e)):No(t,e),So=ko,oe=kn()(So(t=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,setAuth:(e,s,n)=>t({user:e,accessToken:s,refreshToken:n,isAuthenticated:!0}),updateTokens:(e,s)=>t({accessToken:e,refreshToken:s}),logout:()=>t({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1})}),{name:"auth-storage"}));function Sn(t,e){return function(){return t.apply(e,arguments)}}const{toString:Eo}=Object.prototype,{getPrototypeOf:ns}=Object,{iterator:pt,toStringTag:En}=Symbol,mt=(t=>e=>{const s=Eo.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),le=t=>(t=t.toLowerCase(),e=>mt(e)===t),gt=t=>e=>typeof e===t,{isArray:Te}=Array,Oe=gt("undefined");function ze(t){return t!==null&&!Oe(t)&&t.constructor!==null&&!Oe(t.constructor)&&te(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Cn=le("ArrayBuffer");function Co(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Cn(t.buffer),e}const Oo=gt("string"),te=gt("function"),On=gt("number"),Ve=t=>t!==null&&typeof t=="object",Lo=t=>t===!0||t===!1,rt=t=>{if(mt(t)!=="object")return!1;const e=ns(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(En in t)&&!(pt in t)},To=t=>{if(!Ve(t)||ze(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Ro=le("Date"),Po=le("File"),Ao=le("Blob"),Fo=le("FileList"),Io=t=>Ve(t)&&te(t.pipe),Bo=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||te(t.append)&&((e=mt(t))==="formdata"||e==="object"&&te(t.toString)&&t.toString()==="[object FormData]"))},$o=le("URLSearchParams"),[_o,Do,Mo,Uo]=["ReadableStream","Request","Response","Headers"].map(le),Ho=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ke(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let n,r;if(typeof t!="object"&&(t=[t]),Te(t))for(n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else{if(ze(t))return;const o=s?Object.getOwnPropertyNames(t):Object.keys(t),a=o.length;let l;for(n=0;n<a;n++)l=o[n],e.call(null,t[l],l,t)}}function Ln(t,e){if(ze(t))return null;e=e.toLowerCase();const s=Object.keys(t);let n=s.length,r;for(;n-- >0;)if(r=s[n],e===r.toLowerCase())return r;return null}const xe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Tn=t=>!Oe(t)&&t!==xe;function Vt(){const{caseless:t,skipUndefined:e}=Tn(this)&&this||{},s={},n=(r,o)=>{const a=t&&Ln(s,o)||o;rt(s[a])&&rt(r)?s[a]=Vt(s[a],r):rt(r)?s[a]=Vt({},r):Te(r)?s[a]=r.slice():(!e||!Oe(r))&&(s[a]=r)};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Ke(arguments[r],n);return s}const zo=(t,e,s,{allOwnKeys:n}={})=>(Ke(e,(r,o)=>{s&&te(r)?t[o]=Sn(r,s):t[o]=r},{allOwnKeys:n}),t),Vo=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Ko=(t,e,s,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},Wo=(t,e,s,n)=>{let r,o,a;const l={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),o=r.length;o-- >0;)a=r[o],(!n||n(a,t,e))&&!l[a]&&(e[a]=t[a],l[a]=!0);t=s!==!1&&ns(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},qo=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const n=t.indexOf(e,s);return n!==-1&&n===s},Jo=t=>{if(!t)return null;if(Te(t))return t;let e=t.length;if(!On(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},Go=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&ns(Uint8Array)),Yo=(t,e)=>{const n=(t&&t[pt]).call(t);let r;for(;(r=n.next())&&!r.done;){const o=r.value;e.call(t,o[0],o[1])}},Qo=(t,e)=>{let s;const n=[];for(;(s=t.exec(e))!==null;)n.push(s);return n},Xo=le("HTMLFormElement"),Zo=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,r){return n.toUpperCase()+r}),js=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),ei=le("RegExp"),Rn=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),n={};Ke(s,(r,o)=>{let a;(a=e(r,o,t))!==!1&&(n[o]=a||r)}),Object.defineProperties(t,n)},ti=t=>{Rn(t,(e,s)=>{if(te(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=t[s];if(te(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},si=(t,e)=>{const s={},n=r=>{r.forEach(o=>{s[o]=!0})};return Te(t)?n(t):n(String(t).split(e)),s},ni=()=>{},ri=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function oi(t){return!!(t&&te(t.append)&&t[En]==="FormData"&&t[pt])}const ii=t=>{const e=new Array(10),s=(n,r)=>{if(Ve(n)){if(e.indexOf(n)>=0)return;if(ze(n))return n;if(!("toJSON"in n)){e[r]=n;const o=Te(n)?[]:{};return Ke(n,(a,l)=>{const d=s(a,r+1);!Oe(d)&&(o[l]=d)}),e[r]=void 0,o}}return n};return s(t,0)},ai=le("AsyncFunction"),li=t=>t&&(Ve(t)||te(t))&&te(t.then)&&te(t.catch),Pn=((t,e)=>t?setImmediate:e?((s,n)=>(xe.addEventListener("message",({source:r,data:o})=>{r===xe&&o===s&&n.length&&n.shift()()},!1),r=>{n.push(r),xe.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",te(xe.postMessage)),ci=typeof queueMicrotask<"u"?queueMicrotask.bind(xe):typeof process<"u"&&process.nextTick||Pn,di=t=>t!=null&&te(t[pt]),y={isArray:Te,isArrayBuffer:Cn,isBuffer:ze,isFormData:Bo,isArrayBufferView:Co,isString:Oo,isNumber:On,isBoolean:Lo,isObject:Ve,isPlainObject:rt,isEmptyObject:To,isReadableStream:_o,isRequest:Do,isResponse:Mo,isHeaders:Uo,isUndefined:Oe,isDate:Ro,isFile:Po,isBlob:Ao,isRegExp:ei,isFunction:te,isStream:Io,isURLSearchParams:$o,isTypedArray:Go,isFileList:Fo,forEach:Ke,merge:Vt,extend:zo,trim:Ho,stripBOM:Vo,inherits:Ko,toFlatObject:Wo,kindOf:mt,kindOfTest:le,endsWith:qo,toArray:Jo,forEachEntry:Yo,matchAll:Qo,isHTMLForm:Xo,hasOwnProperty:js,hasOwnProp:js,reduceDescriptors:Rn,freezeMethods:ti,toObjectSet:si,toCamelCase:Zo,noop:ni,toFiniteNumber:ri,findKey:Ln,global:xe,isContextDefined:Tn,isSpecCompliantForm:oi,toJSONObject:ii,isAsyncFn:ai,isThenable:li,setImmediate:Pn,asap:ci,isIterable:di};function U(t,e,s,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}y.inherits(U,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:y.toJSONObject(this.config),code:this.code,status:this.status}}});const An=U.prototype,Fn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Fn[t]={value:t}});Object.defineProperties(U,Fn);Object.defineProperty(An,"isAxiosError",{value:!0});U.from=(t,e,s,n,r,o)=>{const a=Object.create(An);y.toFlatObject(t,a,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const l=t&&t.message?t.message:"Error",d=e==null&&t?t.code:e;return U.call(a,l,d,s,n,r),t&&a.cause==null&&Object.defineProperty(a,"cause",{value:t,configurable:!0}),a.name=t&&t.name||"Error",o&&Object.assign(a,o),a};const ui=null;function Kt(t){return y.isPlainObject(t)||y.isArray(t)}function In(t){return y.endsWith(t,"[]")?t.slice(0,-2):t}function Ns(t,e,s){return t?t.concat(e).map(function(r,o){return r=In(r),!s&&o?"["+r+"]":r}).join(s?".":""):e}function hi(t){return y.isArray(t)&&!t.some(Kt)}const fi=y.toFlatObject(y,{},null,function(e){return/^is[A-Z]/.test(e)});function xt(t,e,s){if(!y.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=y.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,x){return!y.isUndefined(x[p])});const n=s.metaTokens,r=s.visitor||u,o=s.dots,a=s.indexes,d=(s.Blob||typeof Blob<"u"&&Blob)&&y.isSpecCompliantForm(e);if(!y.isFunction(r))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(y.isDate(f))return f.toISOString();if(y.isBoolean(f))return f.toString();if(!d&&y.isBlob(f))throw new U("Blob is not supported. Use a Buffer instead.");return y.isArrayBuffer(f)||y.isTypedArray(f)?d&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,p,x){let N=f;if(f&&!x&&typeof f=="object"){if(y.endsWith(p,"{}"))p=n?p:p.slice(0,-2),f=JSON.stringify(f);else if(y.isArray(f)&&hi(f)||(y.isFileList(f)||y.endsWith(p,"[]"))&&(N=y.toArray(f)))return p=In(p),N.forEach(function(E,T){!(y.isUndefined(E)||E===null)&&e.append(a===!0?Ns([p],T,o):a===null?p:p+"[]",c(E))}),!1}return Kt(f)?!0:(e.append(Ns(x,p,o),c(f)),!1)}const h=[],v=Object.assign(fi,{defaultVisitor:u,convertValue:c,isVisitable:Kt});function m(f,p){if(!y.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+p.join("."));h.push(f),y.forEach(f,function(N,j){(!(y.isUndefined(N)||N===null)&&r.call(e,N,y.isString(j)?j.trim():j,p,v))===!0&&m(N,p?p.concat(j):[j])}),h.pop()}}if(!y.isObject(t))throw new TypeError("data must be an object");return m(t),e}function ks(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function rs(t,e){this._pairs=[],t&&xt(t,this,e)}const Bn=rs.prototype;Bn.append=function(e,s){this._pairs.push([e,s])};Bn.toString=function(e){const s=e?function(n){return e.call(this,n,ks)}:ks;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function pi(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function $n(t,e,s){if(!e)return t;const n=s&&s.encode||pi;y.isFunction(s)&&(s={serialize:s});const r=s&&s.serialize;let o;if(r?o=r(e,s):o=y.isURLSearchParams(e)?e.toString():new rs(e,s).toString(n),o){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class Ss{constructor(){this.handlers=[]}use(e,s,n){return this.handlers.push({fulfilled:e,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){y.forEach(this.handlers,function(n){n!==null&&e(n)})}}const _n={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mi=typeof URLSearchParams<"u"?URLSearchParams:rs,gi=typeof FormData<"u"?FormData:null,xi=typeof Blob<"u"?Blob:null,yi={isBrowser:!0,classes:{URLSearchParams:mi,FormData:gi,Blob:xi},protocols:["http","https","file","blob","url","data"]},os=typeof window<"u"&&typeof document<"u",Wt=typeof navigator=="object"&&navigator||void 0,bi=os&&(!Wt||["ReactNative","NativeScript","NS"].indexOf(Wt.product)<0),vi=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wi=os&&window.location.href||"http://localhost",ji=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:os,hasStandardBrowserEnv:bi,hasStandardBrowserWebWorkerEnv:vi,navigator:Wt,origin:wi},Symbol.toStringTag,{value:"Module"})),X={...ji,...yi};function Ni(t,e){return xt(t,new X.classes.URLSearchParams,{visitor:function(s,n,r,o){return X.isNode&&y.isBuffer(s)?(this.append(n,s.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function ki(t){return y.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Si(t){const e={},s=Object.keys(t);let n;const r=s.length;let o;for(n=0;n<r;n++)o=s[n],e[o]=t[o];return e}function Dn(t){function e(s,n,r,o){let a=s[o++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),d=o>=s.length;return a=!a&&y.isArray(r)?r.length:a,d?(y.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n,!l):((!r[a]||!y.isObject(r[a]))&&(r[a]=[]),e(s,n,r[a],o)&&y.isArray(r[a])&&(r[a]=Si(r[a])),!l)}if(y.isFormData(t)&&y.isFunction(t.entries)){const s={};return y.forEachEntry(t,(n,r)=>{e(ki(n),r,s,0)}),s}return null}function Ei(t,e,s){if(y.isString(t))try{return(e||JSON.parse)(t),y.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(t)}const We={transitional:_n,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const n=s.getContentType()||"",r=n.indexOf("application/json")>-1,o=y.isObject(e);if(o&&y.isHTMLForm(e)&&(e=new FormData(e)),y.isFormData(e))return r?JSON.stringify(Dn(e)):e;if(y.isArrayBuffer(e)||y.isBuffer(e)||y.isStream(e)||y.isFile(e)||y.isBlob(e)||y.isReadableStream(e))return e;if(y.isArrayBufferView(e))return e.buffer;if(y.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Ni(e,this.formSerializer).toString();if((l=y.isFileList(e))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return xt(l?{"files[]":e}:e,d&&new d,this.formSerializer)}}return o||r?(s.setContentType("application/json",!1),Ei(e)):e}],transformResponse:[function(e){const s=this.transitional||We.transitional,n=s&&s.forcedJSONParsing,r=this.responseType==="json";if(y.isResponse(e)||y.isReadableStream(e))return e;if(e&&y.isString(e)&&(n&&!this.responseType||r)){const a=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(l){if(a)throw l.name==="SyntaxError"?U.from(l,U.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:X.classes.FormData,Blob:X.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};y.forEach(["delete","get","head","post","put","patch"],t=>{We.headers[t]={}});const Ci=y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Oi=t=>{const e={};let s,n,r;return t&&t.split(`
`).forEach(function(a){r=a.indexOf(":"),s=a.substring(0,r).trim().toLowerCase(),n=a.substring(r+1).trim(),!(!s||e[s]&&Ci[s])&&(s==="set-cookie"?e[s]?e[s].push(n):e[s]=[n]:e[s]=e[s]?e[s]+", "+n:n)}),e},Es=Symbol("internals");function Fe(t){return t&&String(t).trim().toLowerCase()}function ot(t){return t===!1||t==null?t:y.isArray(t)?t.map(ot):String(t)}function Li(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(t);)e[n[1]]=n[2];return e}const Ti=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function At(t,e,s,n,r){if(y.isFunction(n))return n.call(this,e,s);if(r&&(e=s),!!y.isString(e)){if(y.isString(n))return e.indexOf(n)!==-1;if(y.isRegExp(n))return n.test(e)}}function Ri(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,n)=>s.toUpperCase()+n)}function Pi(t,e){const s=y.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+s,{value:function(r,o,a){return this[n].call(this,e,r,o,a)},configurable:!0})})}let se=class{constructor(e){e&&this.set(e)}set(e,s,n){const r=this;function o(l,d,c){const u=Fe(d);if(!u)throw new Error("header name must be a non-empty string");const h=y.findKey(r,u);(!h||r[h]===void 0||c===!0||c===void 0&&r[h]!==!1)&&(r[h||d]=ot(l))}const a=(l,d)=>y.forEach(l,(c,u)=>o(c,u,d));if(y.isPlainObject(e)||e instanceof this.constructor)a(e,s);else if(y.isString(e)&&(e=e.trim())&&!Ti(e))a(Oi(e),s);else if(y.isObject(e)&&y.isIterable(e)){let l={},d,c;for(const u of e){if(!y.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[c=u[0]]=(d=l[c])?y.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}a(l,s)}else e!=null&&o(s,e,n);return this}get(e,s){if(e=Fe(e),e){const n=y.findKey(this,e);if(n){const r=this[n];if(!s)return r;if(s===!0)return Li(r);if(y.isFunction(s))return s.call(this,r,n);if(y.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=Fe(e),e){const n=y.findKey(this,e);return!!(n&&this[n]!==void 0&&(!s||At(this,this[n],n,s)))}return!1}delete(e,s){const n=this;let r=!1;function o(a){if(a=Fe(a),a){const l=y.findKey(n,a);l&&(!s||At(n,n[l],l,s))&&(delete n[l],r=!0)}}return y.isArray(e)?e.forEach(o):o(e),r}clear(e){const s=Object.keys(this);let n=s.length,r=!1;for(;n--;){const o=s[n];(!e||At(this,this[o],o,e,!0))&&(delete this[o],r=!0)}return r}normalize(e){const s=this,n={};return y.forEach(this,(r,o)=>{const a=y.findKey(n,o);if(a){s[a]=ot(r),delete s[o];return}const l=e?Ri(o):String(o).trim();l!==o&&delete s[o],s[l]=ot(r),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return y.forEach(this,(n,r)=>{n!=null&&n!==!1&&(s[r]=e&&y.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const n=new this(e);return s.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[Es]=this[Es]={accessors:{}}).accessors,r=this.prototype;function o(a){const l=Fe(a);n[l]||(Pi(r,a),n[l]=!0)}return y.isArray(e)?e.forEach(o):o(e),this}};se.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);y.reduceDescriptors(se.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[s]=n}}});y.freezeMethods(se);function Ft(t,e){const s=this||We,n=e||s,r=se.from(n.headers);let o=n.data;return y.forEach(t,function(l){o=l.call(s,o,r.normalize(),e?e.status:void 0)}),r.normalize(),o}function Mn(t){return!!(t&&t.__CANCEL__)}function Re(t,e,s){U.call(this,t??"canceled",U.ERR_CANCELED,e,s),this.name="CanceledError"}y.inherits(Re,U,{__CANCEL__:!0});function Un(t,e,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?t(s):e(new U("Request failed with status code "+s.status,[U.ERR_BAD_REQUEST,U.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Ai(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Fi(t,e){t=t||10;const s=new Array(t),n=new Array(t);let r=0,o=0,a;return e=e!==void 0?e:1e3,function(d){const c=Date.now(),u=n[o];a||(a=c),s[r]=d,n[r]=c;let h=o,v=0;for(;h!==r;)v+=s[h++],h=h%t;if(r=(r+1)%t,r===o&&(o=(o+1)%t),c-a<e)return;const m=u&&c-u;return m?Math.round(v*1e3/m):void 0}}function Ii(t,e){let s=0,n=1e3/e,r,o;const a=(c,u=Date.now())=>{s=u,r=null,o&&(clearTimeout(o),o=null),t(...c)};return[(...c)=>{const u=Date.now(),h=u-s;h>=n?a(c,u):(r=c,o||(o=setTimeout(()=>{o=null,a(r)},n-h)))},()=>r&&a(r)]}const at=(t,e,s=3)=>{let n=0;const r=Fi(50,250);return Ii(o=>{const a=o.loaded,l=o.lengthComputable?o.total:void 0,d=a-n,c=r(d),u=a<=l;n=a;const h={loaded:a,total:l,progress:l?a/l:void 0,bytes:d,rate:c||void 0,estimated:c&&l&&u?(l-a)/c:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(h)},s)},Cs=(t,e)=>{const s=t!=null;return[n=>e[0]({lengthComputable:s,total:t,loaded:n}),e[1]]},Os=t=>(...e)=>y.asap(()=>t(...e)),Bi=X.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,X.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(X.origin),X.navigator&&/(msie|trident)/i.test(X.navigator.userAgent)):()=>!0,$i=X.hasStandardBrowserEnv?{write(t,e,s,n,r,o,a){if(typeof document>"u")return;const l=[`${t}=${encodeURIComponent(e)}`];y.isNumber(s)&&l.push(`expires=${new Date(s).toUTCString()}`),y.isString(n)&&l.push(`path=${n}`),y.isString(r)&&l.push(`domain=${r}`),o===!0&&l.push("secure"),y.isString(a)&&l.push(`SameSite=${a}`),document.cookie=l.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function _i(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Di(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Hn(t,e,s){let n=!_i(e);return t&&(n||s==!1)?Di(t,e):e}const Ls=t=>t instanceof se?{...t}:t;function ve(t,e){e=e||{};const s={};function n(c,u,h,v){return y.isPlainObject(c)&&y.isPlainObject(u)?y.merge.call({caseless:v},c,u):y.isPlainObject(u)?y.merge({},u):y.isArray(u)?u.slice():u}function r(c,u,h,v){if(y.isUndefined(u)){if(!y.isUndefined(c))return n(void 0,c,h,v)}else return n(c,u,h,v)}function o(c,u){if(!y.isUndefined(u))return n(void 0,u)}function a(c,u){if(y.isUndefined(u)){if(!y.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function l(c,u,h){if(h in e)return n(c,u);if(h in t)return n(void 0,c)}const d={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(c,u,h)=>r(Ls(c),Ls(u),h,!0)};return y.forEach(Object.keys({...t,...e}),function(u){const h=d[u]||r,v=h(t[u],e[u],u);y.isUndefined(v)&&h!==l||(s[u]=v)}),s}const zn=t=>{const e=ve({},t);let{data:s,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:o,headers:a,auth:l}=e;if(e.headers=a=se.from(a),e.url=$n(Hn(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),y.isFormData(s)){if(X.hasStandardBrowserEnv||X.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(y.isFunction(s.getHeaders)){const d=s.getHeaders(),c=["content-type","content-length"];Object.entries(d).forEach(([u,h])=>{c.includes(u.toLowerCase())&&a.set(u,h)})}}if(X.hasStandardBrowserEnv&&(n&&y.isFunction(n)&&(n=n(e)),n||n!==!1&&Bi(e.url))){const d=r&&o&&$i.read(o);d&&a.set(r,d)}return e},Mi=typeof XMLHttpRequest<"u",Ui=Mi&&function(t){return new Promise(function(s,n){const r=zn(t);let o=r.data;const a=se.from(r.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:c}=r,u,h,v,m,f;function p(){m&&m(),f&&f(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let x=new XMLHttpRequest;x.open(r.method.toUpperCase(),r.url,!0),x.timeout=r.timeout;function N(){if(!x)return;const E=se.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),F={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:E,config:t,request:x};Un(function($){s($),p()},function($){n($),p()},F),x=null}"onloadend"in x?x.onloadend=N:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(N)},x.onabort=function(){x&&(n(new U("Request aborted",U.ECONNABORTED,t,x)),x=null)},x.onerror=function(T){const F=T&&T.message?T.message:"Network Error",D=new U(F,U.ERR_NETWORK,t,x);D.event=T||null,n(D),x=null},x.ontimeout=function(){let T=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const F=r.transitional||_n;r.timeoutErrorMessage&&(T=r.timeoutErrorMessage),n(new U(T,F.clarifyTimeoutError?U.ETIMEDOUT:U.ECONNABORTED,t,x)),x=null},o===void 0&&a.setContentType(null),"setRequestHeader"in x&&y.forEach(a.toJSON(),function(T,F){x.setRequestHeader(F,T)}),y.isUndefined(r.withCredentials)||(x.withCredentials=!!r.withCredentials),l&&l!=="json"&&(x.responseType=r.responseType),c&&([v,f]=at(c,!0),x.addEventListener("progress",v)),d&&x.upload&&([h,m]=at(d),x.upload.addEventListener("progress",h),x.upload.addEventListener("loadend",m)),(r.cancelToken||r.signal)&&(u=E=>{x&&(n(!E||E.type?new Re(null,t,x):E),x.abort(),x=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const j=Ai(r.url);if(j&&X.protocols.indexOf(j)===-1){n(new U("Unsupported protocol "+j+":",U.ERR_BAD_REQUEST,t));return}x.send(o||null)})},Hi=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let n=new AbortController,r;const o=function(c){if(!r){r=!0,l();const u=c instanceof Error?c:this.reason;n.abort(u instanceof U?u:new Re(u instanceof Error?u.message:u))}};let a=e&&setTimeout(()=>{a=null,o(new U(`timeout ${e} of ms exceeded`,U.ETIMEDOUT))},e);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(o):c.removeEventListener("abort",o)}),t=null)};t.forEach(c=>c.addEventListener("abort",o));const{signal:d}=n;return d.unsubscribe=()=>y.asap(l),d}},zi=function*(t,e){let s=t.byteLength;if(s<e){yield t;return}let n=0,r;for(;n<s;)r=n+e,yield t.slice(n,r),n=r},Vi=async function*(t,e){for await(const s of Ki(t))yield*zi(s,e)},Ki=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:n}=await e.read();if(s)break;yield n}}finally{await e.cancel()}},Ts=(t,e,s,n)=>{const r=Vi(t,e);let o=0,a,l=d=>{a||(a=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:c,value:u}=await r.next();if(c){l(),d.close();return}let h=u.byteLength;if(s){let v=o+=h;s(v)}d.enqueue(new Uint8Array(u))}catch(c){throw l(c),c}},cancel(d){return l(d),r.return()}},{highWaterMark:2})},Rs=64*1024,{isFunction:et}=y,Wi=(({Request:t,Response:e})=>({Request:t,Response:e}))(y.global),{ReadableStream:Ps,TextEncoder:As}=y.global,Fs=(t,...e)=>{try{return!!t(...e)}catch{return!1}},qi=t=>{t=y.merge.call({skipUndefined:!0},Wi,t);const{fetch:e,Request:s,Response:n}=t,r=e?et(e):typeof fetch=="function",o=et(s),a=et(n);if(!r)return!1;const l=r&&et(Ps),d=r&&(typeof As=="function"?(f=>p=>f.encode(p))(new As):async f=>new Uint8Array(await new s(f).arrayBuffer())),c=o&&l&&Fs(()=>{let f=!1;const p=new s(X.origin,{body:new Ps,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!p}),u=a&&l&&Fs(()=>y.isReadableStream(new n("").body)),h={stream:u&&(f=>f.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!h[f]&&(h[f]=(p,x)=>{let N=p&&p[f];if(N)return N.call(p);throw new U(`Response type '${f}' is not supported`,U.ERR_NOT_SUPPORT,x)})});const v=async f=>{if(f==null)return 0;if(y.isBlob(f))return f.size;if(y.isSpecCompliantForm(f))return(await new s(X.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(y.isArrayBufferView(f)||y.isArrayBuffer(f))return f.byteLength;if(y.isURLSearchParams(f)&&(f=f+""),y.isString(f))return(await d(f)).byteLength},m=async(f,p)=>{const x=y.toFiniteNumber(f.getContentLength());return x??v(p)};return async f=>{let{url:p,method:x,data:N,signal:j,cancelToken:E,timeout:T,onDownloadProgress:F,onUploadProgress:D,responseType:$,headers:J,withCredentials:_="same-origin",fetchOptions:I}=zn(f),Q=e||fetch;$=$?($+"").toLowerCase():"text";let k=Hi([j,E&&E.toAbortSignal()],T),R=null;const g=k&&k.unsubscribe&&(()=>{k.unsubscribe()});let S;try{if(D&&c&&x!=="get"&&x!=="head"&&(S=await m(J,N))!==0){let M=new s(p,{method:"POST",body:N,duplex:"half"}),G;if(y.isFormData(N)&&(G=M.headers.get("content-type"))&&J.setContentType(G),M.body){const[ne,W]=Cs(S,at(Os(D)));N=Ts(M.body,Rs,ne,W)}}y.isString(_)||(_=_?"include":"omit");const P=o&&"credentials"in s.prototype,H={...I,signal:k,method:x.toUpperCase(),headers:J.normalize().toJSON(),body:N,duplex:"half",credentials:P?_:void 0};R=o&&new s(p,H);let C=await(o?Q(R,I):Q(p,H));const K=u&&($==="stream"||$==="response");if(u&&(F||K&&g)){const M={};["status","statusText","headers"].forEach(ie=>{M[ie]=C[ie]});const G=y.toFiniteNumber(C.headers.get("content-length")),[ne,W]=F&&Cs(G,at(Os(F),!0))||[];C=new n(Ts(C.body,Rs,ne,()=>{W&&W(),g&&g()}),M)}$=$||"text";let q=await h[y.findKey(h,$)||"text"](C,f);return!K&&g&&g(),await new Promise((M,G)=>{Un(M,G,{data:q,headers:se.from(C.headers),status:C.status,statusText:C.statusText,config:f,request:R})})}catch(P){throw g&&g(),P&&P.name==="TypeError"&&/Load failed|fetch/i.test(P.message)?Object.assign(new U("Network Error",U.ERR_NETWORK,f,R),{cause:P.cause||P}):U.from(P,P&&P.code,f,R)}}},Ji=new Map,Vn=t=>{let e=t&&t.env||{};const{fetch:s,Request:n,Response:r}=e,o=[n,r,s];let a=o.length,l=a,d,c,u=Ji;for(;l--;)d=o[l],c=u.get(d),c===void 0&&u.set(d,c=l?new Map:qi(e)),u=c;return c};Vn();const is={http:ui,xhr:Ui,fetch:{get:Vn}};y.forEach(is,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Is=t=>`- ${t}`,Gi=t=>y.isFunction(t)||t===null||t===!1;function Yi(t,e){t=y.isArray(t)?t:[t];const{length:s}=t;let n,r;const o={};for(let a=0;a<s;a++){n=t[a];let l;if(r=n,!Gi(n)&&(r=is[(l=String(n)).toLowerCase()],r===void 0))throw new U(`Unknown adapter '${l}'`);if(r&&(y.isFunction(r)||(r=r.get(e))))break;o[l||"#"+a]=r}if(!r){const a=Object.entries(o).map(([d,c])=>`adapter ${d} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=s?a.length>1?`since :
`+a.map(Is).join(`
`):" "+Is(a[0]):"as no adapter specified";throw new U("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r}const Kn={getAdapter:Yi,adapters:is};function It(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Re(null,t)}function Bs(t){return It(t),t.headers=se.from(t.headers),t.data=Ft.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Kn.getAdapter(t.adapter||We.adapter,t)(t).then(function(n){return It(t),n.data=Ft.call(t,t.transformResponse,n),n.headers=se.from(n.headers),n},function(n){return Mn(n)||(It(t),n&&n.response&&(n.response.data=Ft.call(t,t.transformResponse,n.response),n.response.headers=se.from(n.response.headers))),Promise.reject(n)})}const Wn="1.13.2",yt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{yt[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const $s={};yt.transitional=function(e,s,n){function r(o,a){return"[Axios v"+Wn+"] Transitional option '"+o+"'"+a+(n?". "+n:"")}return(o,a,l)=>{if(e===!1)throw new U(r(a," has been removed"+(s?" in "+s:"")),U.ERR_DEPRECATED);return s&&!$s[a]&&($s[a]=!0,console.warn(r(a," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(o,a,l):!0}};yt.spelling=function(e){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Qi(t,e,s){if(typeof t!="object")throw new U("options must be an object",U.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let r=n.length;for(;r-- >0;){const o=n[r],a=e[o];if(a){const l=t[o],d=l===void 0||a(l,o,t);if(d!==!0)throw new U("option "+o+" must be "+d,U.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new U("Unknown option "+o,U.ERR_BAD_OPTION)}}const it={assertOptions:Qi,validators:yt},ce=it.validators;let ye=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Ss,response:new Ss}}async request(e,s){try{return await this._request(e,s)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=ve(this.defaults,s);const{transitional:n,paramsSerializer:r,headers:o}=s;n!==void 0&&it.assertOptions(n,{silentJSONParsing:ce.transitional(ce.boolean),forcedJSONParsing:ce.transitional(ce.boolean),clarifyTimeoutError:ce.transitional(ce.boolean)},!1),r!=null&&(y.isFunction(r)?s.paramsSerializer={serialize:r}:it.assertOptions(r,{encode:ce.function,serialize:ce.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),it.assertOptions(s,{baseUrl:ce.spelling("baseURL"),withXsrfToken:ce.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let a=o&&y.merge(o.common,o[s.method]);o&&y.forEach(["delete","get","head","post","put","patch","common"],f=>{delete o[f]}),s.headers=se.concat(a,o);const l=[];let d=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(s)===!1||(d=d&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const c=[];this.interceptors.response.forEach(function(p){c.push(p.fulfilled,p.rejected)});let u,h=0,v;if(!d){const f=[Bs.bind(this),void 0];for(f.unshift(...l),f.push(...c),v=f.length,u=Promise.resolve(s);h<v;)u=u.then(f[h++],f[h++]);return u}v=l.length;let m=s;for(;h<v;){const f=l[h++],p=l[h++];try{m=f(m)}catch(x){p.call(this,x);break}}try{u=Bs.call(this,m)}catch(f){return Promise.reject(f)}for(h=0,v=c.length;h<v;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=ve(this.defaults,e);const s=Hn(e.baseURL,e.url,e.allowAbsoluteUrls);return $n(s,e.params,e.paramsSerializer)}};y.forEach(["delete","get","head","options"],function(e){ye.prototype[e]=function(s,n){return this.request(ve(n||{},{method:e,url:s,data:(n||{}).data}))}});y.forEach(["post","put","patch"],function(e){function s(n){return function(o,a,l){return this.request(ve(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}ye.prototype[e]=s(),ye.prototype[e+"Form"]=s(!0)});let Xi=class qn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(o){s=o});const n=this;this.promise.then(r=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](r);n._listeners=null}),this.promise.then=r=>{let o;const a=new Promise(l=>{n.subscribe(l),o=l}).then(r);return a.cancel=function(){n.unsubscribe(o)},a},e(function(o,a,l){n.reason||(n.reason=new Re(o,a,l),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=n=>{e.abort(n)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new qn(function(r){e=r}),cancel:e}}};function Zi(t){return function(s){return t.apply(null,s)}}function ea(t){return y.isObject(t)&&t.isAxiosError===!0}const qt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(qt).forEach(([t,e])=>{qt[e]=t});function Jn(t){const e=new ye(t),s=Sn(ye.prototype.request,e);return y.extend(s,ye.prototype,e,{allOwnKeys:!0}),y.extend(s,e,null,{allOwnKeys:!0}),s.create=function(r){return Jn(ve(t,r))},s}const Y=Jn(We);Y.Axios=ye;Y.CanceledError=Re;Y.CancelToken=Xi;Y.isCancel=Mn;Y.VERSION=Wn;Y.toFormData=xt;Y.AxiosError=U;Y.Cancel=Y.CanceledError;Y.all=function(e){return Promise.all(e)};Y.spread=Zi;Y.isAxiosError=ea;Y.mergeConfig=ve;Y.AxiosHeaders=se;Y.formToJSON=t=>Dn(y.isHTMLForm(t)?new FormData(t):t);Y.getAdapter=Kn.getAdapter;Y.HttpStatusCode=qt;Y.default=Y;const{Axios:$c,AxiosError:_c,CanceledError:Dc,isCancel:Mc,CancelToken:Uc,VERSION:Hc,all:zc,Cancel:Vc,isAxiosError:Kc,spread:Wc,toFormData:qc,AxiosHeaders:Jc,HttpStatusCode:Gc,formToJSON:Yc,getAdapter:Qc,mergeConfig:Xc}=Y;function Pe(){const t=window.AUDIOBOOKSHELF_CONFIG;return t!=null&&t.tunnelUrl?`${t.tunnelUrl}/api`:(console.error("No tunnelUrl configured. Please ensure config.js is present."),"/api")}const V=Y.create({baseURL:Pe(),headers:{"Content-Type":"application/json"}});function ta(t){try{const s=JSON.parse(atob(t.split(".")[1])).exp*1e3,n=Date.now();return s-n<5*60*1e3}catch{return!0}}function sa(t){try{const s=JSON.parse(atob(t.split(".")[1])).exp*1e3;return Date.now()>=s}catch{return!0}}let Bt=!1,Ie=null;async function Gn(){if(Bt&&Ie)return Ie;const{refreshToken:t,updateTokens:e,logout:s}=oe.getState();return t?(Bt=!0,Ie=(async()=>{var n,r;try{const o=await Y.post(`${Pe()}/auth/refresh`,{refreshToken:t}),{accessToken:a,refreshToken:l}=o.data.data;return e(a,l),!0}catch(o){const a=o;return(((n=a==null?void 0:a.response)==null?void 0:n.status)===401||((r=a==null?void 0:a.response)==null?void 0:r.status)===403)&&s(),!1}finally{Bt=!1,Ie=null}})(),Ie):!1}V.interceptors.request.use(async t=>{var r;if((r=t.url)==null?void 0:r.startsWith("/auth/"))return t;const{accessToken:s,refreshToken:n}=oe.getState();if(s)if(!sa(s)&&ta(s)&&n){await Gn();const{accessToken:o}=oe.getState();t.headers.Authorization=`Bearer ${o}`}else t.headers.Authorization=`Bearer ${s}`;return t});V.interceptors.response.use(t=>t,async t=>{var n,r;const e=t.config;if((n=e==null?void 0:e.url)==null?void 0:n.startsWith("/auth/"))return Promise.reject(t);if(((r=t.response)==null?void 0:r.status)===401&&!e._retry)if(e._retry=!0,await Gn()){const{accessToken:a}=oe.getState();return e.headers.Authorization=`Bearer ${a}`,V(e)}else return window.location.pathname.includes("/login")||(window.location.href="/login"),Promise.reject(t);return Promise.reject(t)});const Jt=(t,e)=>e.some(s=>t instanceof s);let _s,Ds;function na(){return _s||(_s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ra(){return Ds||(Ds=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Gt=new WeakMap,$t=new WeakMap,bt=new WeakMap;function oa(t){const e=new Promise((s,n)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{s(be(t.result)),r()},a=()=>{n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",a)});return bt.set(e,t),e}function ia(t){if(Gt.has(t))return;const e=new Promise((s,n)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{s(),r()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Gt.set(t,e)}let Yt={get(t,e,s){if(t instanceof IDBTransaction){if(e==="done")return Gt.get(t);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return be(t[e])},set(t,e,s){return t[e]=s,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Yn(t){Yt=t(Yt)}function aa(t){return ra().includes(t)?function(...e){return t.apply(Qt(this),e),be(this.request)}:function(...e){return be(t.apply(Qt(this),e))}}function la(t){return typeof t=="function"?aa(t):(t instanceof IDBTransaction&&ia(t),Jt(t,na())?new Proxy(t,Yt):t)}function be(t){if(t instanceof IDBRequest)return oa(t);if($t.has(t))return $t.get(t);const e=la(t);return e!==t&&($t.set(t,e),bt.set(e,t)),e}const Qt=t=>bt.get(t);function ca(t,e,{blocked:s,upgrade:n,blocking:r,terminated:o}={}){const a=indexedDB.open(t,e),l=be(a);return n&&a.addEventListener("upgradeneeded",d=>{n(be(a.result),d.oldVersion,d.newVersion,be(a.transaction),d)}),s&&a.addEventListener("blocked",d=>s(d.oldVersion,d.newVersion,d)),l.then(d=>{o&&d.addEventListener("close",()=>o()),r&&d.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const da=["get","getKey","getAll","getAllKeys","count"],ua=["put","add","delete","clear"],_t=new Map;function Ms(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_t.get(e))return _t.get(e);const s=e.replace(/FromIndex$/,""),n=e!==s,r=ua.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||da.includes(s)))return;const o=async function(a,...l){const d=this.transaction(a,r?"readwrite":"readonly");let c=d.store;return n&&(c=c.index(l.shift())),(await Promise.all([c[s](...l),r&&d.done]))[0]};return _t.set(e,o),o}Yn(t=>({...t,get:(e,s,n)=>Ms(e,s)||t.get(e,s,n),has:(e,s)=>!!Ms(e,s)||t.has(e,s)}));const ha=["continue","continuePrimaryKey","advance"],Us={},Xt=new WeakMap,Qn=new WeakMap,fa={get(t,e){if(!ha.includes(e))return t[e];let s=Us[e];return s||(s=Us[e]=function(...n){Xt.set(this,Qn.get(this)[e](...n))}),s}};async function*pa(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const s=new Proxy(e,fa);for(Qn.set(s,e),bt.set(s,Qt(e));e;)yield s,e=await(Xt.get(s)||e.continue()),Xt.delete(s)}function Hs(t,e){return e===Symbol.asyncIterator&&Jt(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Jt(t,[IDBIndex,IDBObjectStore])}Yn(t=>({...t,get(e,s,n){return Hs(e,s)?pa:t.get(e,s,n)},has(e,s){return Hs(e,s)||t.has(e,s)}}));class ma{constructor(){me(this,"db",null)}async init(){this.db=await ca("audiobook-db",1,{upgrade(e){e.createObjectStore("history",{keyPath:"bookId"}).createIndex("by-sync-status","syncStatus"),e.createObjectStore("books",{keyPath:"id"}),e.createObjectStore("auth")}})}async saveHistory(e){this.db||await this.init(),await this.db.put("history",e)}async getHistory(e){return this.db||await this.init(),await this.db.get("history",e)}async getAllPendingHistory(){return this.db||await this.init(),await this.db.getAllFromIndex("history","by-sync-status","pending")}async markHistorySynced(e){const s=await this.getHistory(e);s&&(s.syncStatus="synced",await this.saveHistory(s))}async cacheBook(e){this.db||await this.init(),await this.db.put("books",e)}async getBook(e){return this.db||await this.init(),await this.db.get("books",e)}async saveAuth(e){this.db||await this.init(),await this.db.put("auth",e,"tokens")}async getAuth(){return this.db||await this.init(),await this.db.get("auth","tokens")}async clearAuth(){this.db||await this.init(),await this.db.delete("auth","tokens")}}const Be=new ma;let zs=0;const ga=5e3,qe=kn()((t,e)=>({bookId:null,book:null,currentEpisode:0,audioUrl:null,history:null,isPlaying:!1,currentTime:0,duration:0,shouldAutoPlay:!0,sleepTimerMinutes:null,sleepTimerRemaining:0,isMinimized:!1,isLoading:!1,error:null,loadBook:async s=>{var o,a;const n=e().bookId,r=e().book;if(!(n===s&&r)){n&&n!==s&&await e().syncHistory(),t({isLoading:!0,error:null});try{const[l,d]=await Promise.all([V.get(`/books/${s}`),V.get(`/history/book/${s}`)]),c=l.data.data,u=d.data.data,h=(u==null?void 0:u.episode_index)??0,v=(u==null?void 0:u.current_time_seconds)??0;t({bookId:s,book:c,history:u,currentEpisode:h,currentTime:v,isLoading:!1});try{await e().fetchEpisodeUrl(s,h)}catch(m){console.error("Failed to fetch initial episode URL:",m)}}catch(l){t({error:((a=(o=l.response)==null?void 0:o.data)==null?void 0:a.error)||"Failed to load book",isLoading:!1})}}},fetchEpisodeUrl:async(s,n)=>{const{accessToken:r}=oe.getState(),o=await V.get(`/books/${s}/episodes/${n}/url`),{url:a}=o.data.data;if(!a)throw new Error("Episode URL is empty or invalid");if(a.includes("/storage/")){const l=`${Pe()}/books/${s}/episodes/${n}/stream`;t({audioUrl:`${l}?token=${r}`})}else t({audioUrl:a})},setEpisode:async s=>{var a;const{book:n,bookId:r,syncHistory:o}=e();if(!n||!r)throw new Error("No book loaded");if(s<0||s>=(((a=n.episodes)==null?void 0:a.length)||0))throw new Error("Invalid episode index");await o(),t({currentEpisode:s,currentTime:0,shouldAutoPlay:!0,history:null}),await e().fetchEpisodeUrl(r,s)},setPlaying:s=>t({isPlaying:s}),setTime:s=>{t({currentTime:s});const n=Date.now();if(n-zs>=ga){zs=n;const{bookId:r,currentEpisode:o}=e();r&&s>0&&Be.saveHistory({bookId:r,currentTime:Math.floor(s),episodeIndex:o,playbackRate:1,lastPlayedAt:new Date().toISOString(),syncStatus:"pending"}).catch(console.error)}},setDuration:s=>t({duration:s}),setShouldAutoPlay:s=>t({shouldAutoPlay:s}),setMinimized:s=>t({isMinimized:s}),setAudioUrl:s=>t({audioUrl:s}),setSleepTimer:s=>{t({sleepTimerMinutes:s,sleepTimerRemaining:s*60})},cancelSleepTimer:()=>{t({sleepTimerMinutes:null,sleepTimerRemaining:0})},decrementSleepTimer:()=>{const{sleepTimerRemaining:s}=e();return s<=1?(t({sleepTimerMinutes:null,sleepTimerRemaining:0}),!0):(t({sleepTimerRemaining:s-1}),!1)},syncHistory:async()=>{const{bookId:s,currentEpisode:n,currentTime:r}=e();if(s)try{await V.post("/history/sync",{bookId:s,currentTime:Math.floor(r),episodeIndex:n,playbackRate:1,lastPlayedAt:new Date().toISOString()})}catch(o){console.error("Failed to sync history:",o)}},syncHistoryBeacon:()=>{const{bookId:s,currentEpisode:n,currentTime:r}=e();if(!s||r<=0)return;const{accessToken:o}=oe.getState(),a=JSON.stringify({bookId:s,currentTime:Math.floor(r),episodeIndex:n,playbackRate:1,lastPlayedAt:new Date().toISOString()});Be.saveHistory({bookId:s,currentTime:Math.floor(r),episodeIndex:n,playbackRate:1,lastPlayedAt:new Date().toISOString(),syncStatus:"pending"}).catch(()=>{});const l=`/api/history/sync?token=${o}`;navigator.sendBeacon(l,new Blob([a],{type:"application/json"}))&&Be.markHistorySynced(s).catch(()=>{})},syncPendingHistory:async()=>{try{const s=await Be.getAllPendingHistory();for(const n of s)try{await V.post("/history/sync",{bookId:n.bookId,currentTime:n.currentTime,episodeIndex:n.episodeIndex,playbackRate:n.playbackRate,lastPlayedAt:n.lastPlayedAt}),await Be.markHistorySynced(n.bookId)}catch(r){console.error("Failed to sync pending history for book:",n.bookId,r)}}catch(s){console.error("Failed to get pending history:",s)}},loadMostRecentFromHistory:async()=>{if(!e().bookId)try{const n=(await V.get("/history/most-recent")).data.data;if(!n)return;const{history:r,book:o}=n;t({bookId:r.book_id,book:o,history:r,currentEpisode:r.episode_index,currentTime:r.current_time_seconds,shouldAutoPlay:!1,isLoading:!1});try{await e().fetchEpisodeUrl(r.book_id,r.episode_index)}catch(a){console.error("Failed to fetch episode URL for recent history:",a)}}catch(s){console.error("Failed to load most recent history:",s)}},clearPlayer:()=>{t({bookId:null,book:null,currentEpisode:0,audioUrl:null,history:null,isPlaying:!1,currentTime:0,duration:0,shouldAutoPlay:!0,sleepTimerMinutes:null,sleepTimerRemaining:0,isMinimized:!1,isLoading:!1,error:null})}})),xa={maxRetries:5,retryInterval:2e3,onRetry:()=>{},onSuccess:()=>{},onFailure:()=>{}};class ya{constructor(e={}){me(this,"config");this.config={...xa,...e}}async execute(e){const s=Date.now();let n;for(let r=0;r<=this.config.maxRetries;r++)try{const o=await e();return this.config.onSuccess(r),{success:!0,data:o,attempts:r+1,totalDuration:Date.now()-s}}catch(o){n=o instanceof Error?o:new Error(String(o)),r<this.config.maxRetries&&(this.config.onRetry(r+1,n),await this.delay(this.config.retryInterval))}return this.config.onFailure(this.config.maxRetries+1,n),{success:!1,attempts:this.config.maxRetries+1,totalDuration:Date.now()-s,lastError:n}}delay(e){return new Promise(s=>setTimeout(s,e))}}const ba=10,va=5e3,Vs=5;class wa{constructor(){me(this,"sessionId");me(this,"eventQueue",[]);me(this,"flushTimeout",null);me(this,"isFlushing",!1);this.sessionId=this.generateSessionId(),typeof window<"u"&&(window.addEventListener("beforeunload",()=>{this.flushSync()}),window.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&this.flush()}))}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}getClientInfo(){var s;if(typeof window>"u")return{userAgent:"server",platform:"server",language:"en",screenSize:"0x0"};const e=navigator;return{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,screenSize:`${window.screen.width}x${window.screen.height}`,connectionType:(s=e.connection)==null?void 0:s.effectiveType}}track(e,s,n,r,o){const a={category:e,level:s,sessionId:this.sessionId,context:{...n,maxRetries:n.maxRetries??Vs},error:o,client:this.getClientInfo(),outcome:r,clientTimestamp:new Date().toISOString()};this.eventQueue.push(a),this.eventQueue.length>=ba?this.flush():this.scheduleFlush()}scheduleFlush(){this.flushTimeout||(this.flushTimeout=setTimeout(()=>{this.flush()},va))}async flush(){if(this.flushTimeout&&(clearTimeout(this.flushTimeout),this.flushTimeout=null),this.eventQueue.length===0||this.isFlushing)return;this.isFlushing=!0;const e=[...this.eventQueue];this.eventQueue=[],V.post("/telemetry/errors",{events:e}).catch(()=>{}).finally(()=>{this.isFlushing=!1})}flushSync(){if(this.eventQueue.length===0)return;const e=[...this.eventQueue];this.eventQueue=[];try{const s=JSON.stringify({events:e});navigator.sendBeacon(`${Pe()}/telemetry/errors`,new Blob([s],{type:"application/json"}))}catch{}}trackEpisodeFetchError(e,s,n,r,o){this.track("EPISODE_FETCH_FAILED","error",{bookId:e,episodeIndex:s,retryAttempt:n},o,{message:r.message,stack:r.stack})}trackAudioPlayError(e,s,n,r,o){this.track("AUDIO_PLAY_FAILED","error",{bookId:e,episodeIndex:s,retryAttempt:n},o,{message:r.message,stack:r.stack})}trackRetrySuccess(e,s,n,r){this.track("RETRY_SUCCEEDED","info",{bookId:e,episodeIndex:s,retryAttempt:n-1,totalRetryDuration:r},"success")}trackRetryExhausted(e,s,n,r){this.track("RETRY_EXHAUSTED","error",{bookId:e,episodeIndex:s,retryAttempt:Vs,totalRetryDuration:n},"failure",{message:r.message,stack:r.stack})}trackMediaError(e,s,n){var r;this.track("MEDIA_ERROR","error",{bookId:e,episodeIndex:s},"failure",{message:(n==null?void 0:n.message)||"Unknown media error",code:(r=n==null?void 0:n.code)==null?void 0:r.toString()})}getSessionId(){return this.sessionId}}const tt=new wa,Xn=b.createContext(null);function ja({children:t}){const e=b.useRef(null),s=b.useRef(null),n=b.useRef(null),r=b.useRef(!1),{isAuthenticated:o}=oe(),{audioUrl:a,isPlaying:l,currentEpisode:d,book:c,bookId:u,history:h,shouldAutoPlay:v,sleepTimerMinutes:m,sleepTimerRemaining:f,setPlaying:p,setTime:x,setDuration:N,setShouldAutoPlay:j,setEpisode:E,syncHistory:T,syncHistoryBeacon:F,syncPendingHistory:D,loadMostRecentFromHistory:$,decrementSleepTimer:J}=qe();b.useEffect(()=>{o&&D().then(()=>{$()})},[o,D,$]);const _=b.useCallback(()=>{const g=e.current;g&&(j(!0),g.play().catch(S=>{console.log("Play blocked:",S),p(!1)}))},[j,p]),I=b.useCallback(async()=>{const g=e.current;g&&(g.pause(),await T())},[T]),Q=b.useCallback(()=>{l?I():_()},[l,_,I]),k=b.useCallback(g=>{const S=e.current;S&&(S.currentTime=g,x(g))},[x]),R=b.useCallback(g=>{const S=e.current;if(!S)return;const P=Math.max(0,Math.min(S.currentTime+g,S.duration||0));S.currentTime=P,x(P)},[x]);return b.useEffect(()=>{const g=e.current;if(!g)return;const S=()=>x(g.currentTime),P=()=>N(g.duration||0),H=()=>p(!0),C=()=>p(!1),K=async()=>{var ie;if(r.current)return;const M=d+1;if(!(c&&M<(((ie=c.episodes)==null?void 0:ie.length)||0))){p(!1),j(!1);return}r.current=!0,j(!0);const W=await new ya({maxRetries:5,retryInterval:2e3,onRetry:(ue,je)=>{console.log(`Episode transition retry ${ue}/5:`,je.message),u&&tt.trackEpisodeFetchError(u,M,ue,je,"retrying")}}).execute(async()=>{if(await E(M),await new Promise(ue=>setTimeout(ue,100)),e.current&&e.current.src)await e.current.play();else throw new Error("Audio element not ready");return!0});W.success?W.attempts>1&&u&&tt.trackRetrySuccess(u,M,W.attempts,W.totalDuration):(console.error("Episode transition failed after all retries:",W.lastError),p(!1),u&&W.lastError&&tt.trackRetryExhausted(u,M,W.totalDuration,W.lastError)),r.current=!1},q=M=>{if(console.error("Audio error:",M),u){const G=M.target;tt.trackMediaError(u,d,G==null?void 0:G.error)}};return g.addEventListener("timeupdate",S),g.addEventListener("durationchange",P),g.addEventListener("play",H),g.addEventListener("pause",C),g.addEventListener("ended",K),g.addEventListener("error",q),()=>{g.removeEventListener("timeupdate",S),g.removeEventListener("durationchange",P),g.removeEventListener("play",H),g.removeEventListener("pause",C),g.removeEventListener("ended",K),g.removeEventListener("error",q)}},[c,d,x,N,p,j,E]),b.useEffect(()=>{const g=e.current;!g||!a||(g.src=a,g.load())},[a]),b.useEffect(()=>{const g=e.current;if(!g)return;const S=()=>{h&&h.episode_index===d&&h.current_time_seconds>0&&(g.currentTime=h.current_time_seconds),v&&g.play().catch(P=>{console.log("Auto-play blocked:",P),p(!1)})};return g.addEventListener("loadedmetadata",S),()=>g.removeEventListener("loadedmetadata",S)},[h,d,v,p]),b.useEffect(()=>{if(s.current&&(clearInterval(s.current),s.current=null),!(!l||!u))return s.current=setInterval(()=>{T()},3e4),()=>{s.current&&clearInterval(s.current)}},[l,u,T]),b.useEffect(()=>{if(n.current&&(clearInterval(n.current),n.current=null),!(m===null||f<=0||!l))return n.current=setInterval(()=>{J()&&I()},1e3),()=>{n.current&&clearInterval(n.current)}},[m,f,l,J,I]),b.useEffect(()=>{const g=()=>{F()};return window.addEventListener("beforeunload",g),()=>window.removeEventListener("beforeunload",g)},[F]),b.useEffect(()=>{const g=()=>{document.visibilityState==="visible"?D().then(()=>{u&&$()}):document.visibilityState==="hidden"&&l&&T()};return document.addEventListener("visibilitychange",g),()=>document.removeEventListener("visibilitychange",g)},[l,u,T,D,$]),b.useEffect(()=>{var S,P;if(!("mediaSession"in navigator)||!c)return;navigator.mediaSession.metadata=new MediaMetadata({title:((P=(S=c.episodes)==null?void 0:S[d])==null?void 0:P.title)||c.title,artist:c.author||"Unknown Author",album:c.title,artwork:c.cover_url?[{src:`${Pe()}/books/${c.id}/cover`,sizes:"512x512",type:"image/jpeg"}]:[]}),navigator.mediaSession.playbackState=l?"playing":"paused",navigator.mediaSession.setActionHandler("play",()=>_()),navigator.mediaSession.setActionHandler("pause",()=>I()),navigator.mediaSession.setActionHandler("seekbackward",()=>R(-30)),navigator.mediaSession.setActionHandler("seekforward",()=>R(30)),navigator.mediaSession.setActionHandler("previoustrack",()=>{d>0&&E(d-1)}),navigator.mediaSession.setActionHandler("nexttrack",()=>{var H;c&&d<(((H=c.episodes)==null?void 0:H.length)||0)-1&&E(d+1)});const g=e.current;if(g&&g.duration&&!isNaN(g.duration))try{navigator.mediaSession.setPositionState({duration:g.duration,playbackRate:g.playbackRate,position:g.currentTime})}catch{}return()=>{navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("nexttrack",null)}},[c,d,l,_,I,R,E]),i.jsxs(Xn.Provider,{value:{audioRef:e,play:_,pause:I,togglePlay:Q,seek:k,skipTime:R},children:[i.jsx("audio",{ref:e}),t]})}function Zn(){const t=b.useContext(Xn);if(!t)throw new Error("useAudioPlayer must be used within AudioPlayerProvider");return t}const B=t=>typeof t=="string",$e=()=>{let t,e;const s=new Promise((n,r)=>{t=n,e=r});return s.resolve=t,s.reject=e,s},Ks=t=>t==null?"":""+t,Na=(t,e,s)=>{t.forEach(n=>{e[n]&&(s[n]=e[n])})},ka=/###/g,Ws=t=>t&&t.indexOf("###")>-1?t.replace(ka,"."):t,qs=t=>!t||B(t),_e=(t,e,s)=>{const n=B(e)?e.split("."):e;let r=0;for(;r<n.length-1;){if(qs(t))return{};const o=Ws(n[r]);!t[o]&&s&&(t[o]=new s),Object.prototype.hasOwnProperty.call(t,o)?t=t[o]:t={},++r}return qs(t)?{}:{obj:t,k:Ws(n[r])}},Js=(t,e,s)=>{const{obj:n,k:r}=_e(t,e,Object);if(n!==void 0||e.length===1){n[r]=s;return}let o=e[e.length-1],a=e.slice(0,e.length-1),l=_e(t,a,Object);for(;l.obj===void 0&&a.length;)o=`${a[a.length-1]}.${o}`,a=a.slice(0,a.length-1),l=_e(t,a,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${o}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${o}`]=s},Sa=(t,e,s,n)=>{const{obj:r,k:o}=_e(t,e,Object);r[o]=r[o]||[],r[o].push(s)},lt=(t,e)=>{const{obj:s,k:n}=_e(t,e);if(s&&Object.prototype.hasOwnProperty.call(s,n))return s[n]},Ea=(t,e,s)=>{const n=lt(t,s);return n!==void 0?n:lt(e,s)},er=(t,e,s)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in t?B(t[n])||t[n]instanceof String||B(e[n])||e[n]instanceof String?s&&(t[n]=e[n]):er(t[n],e[n],s):t[n]=e[n]);return t},ke=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Ca={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Oa=t=>B(t)?t.replace(/[&<>"'\/]/g,e=>Ca[e]):t;class La{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const s=this.regExpMap.get(e);if(s!==void 0)return s;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const Ta=[" ",",","?","!",";"],Ra=new La(20),Pa=(t,e,s)=>{e=e||"",s=s||"";const n=Ta.filter(a=>e.indexOf(a)<0&&s.indexOf(a)<0);if(n.length===0)return!0;const r=Ra.getRegExp(`(${n.map(a=>a==="?"?"\\?":a).join("|")})`);let o=!r.test(t);if(!o){const a=t.indexOf(s);a>0&&!r.test(t.substring(0,a))&&(o=!0)}return o},Zt=(t,e,s=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const n=e.split(s);let r=t;for(let o=0;o<n.length;){if(!r||typeof r!="object")return;let a,l="";for(let d=o;d<n.length;++d)if(d!==o&&(l+=s),l+=n[d],a=r[l],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&d<n.length-1)continue;o+=d-o+1;break}r=a}return r},Ue=t=>t==null?void 0:t.replace("_","-"),Aa={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var s,n;(n=(s=console==null?void 0:console[t])==null?void 0:s.apply)==null||n.call(s,console,e)}};class ct{constructor(e,s={}){this.init(e,s)}init(e,s={}){this.prefix=s.prefix||"i18next:",this.logger=e||Aa,this.options=s,this.debug=s.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,s,n,r){return r&&!this.debug?null:(B(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[s](e))}create(e){return new ct(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ct(this.logger,e)}}var de=new ct;class vt{constructor(){this.observers={}}on(e,s){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const r=this.observers[n].get(s)||0;this.observers[n].set(s,r+1)}),this}off(e,s){if(this.observers[e]){if(!s){delete this.observers[e];return}this.observers[e].delete(s)}}emit(e,...s){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([r,o])=>{for(let a=0;a<o;a++)r(...s)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([r,o])=>{for(let a=0;a<o;a++)r.apply(r,[e,...s])})}}class Gs extends vt{constructor(e,s={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=s,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const s=this.options.ns.indexOf(e);s>-1&&this.options.ns.splice(s,1)}getResource(e,s,n,r={}){var c,u;const o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,a=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,s],n&&(Array.isArray(n)?l.push(...n):B(n)&&o?l.push(...n.split(o)):l.push(n)));const d=lt(this.data,l);return!d&&!s&&!n&&e.indexOf(".")>-1&&(e=l[0],s=l[1],n=l.slice(2).join(".")),d||!a||!B(n)?d:Zt((u=(c=this.data)==null?void 0:c[e])==null?void 0:u[s],n,o)}addResource(e,s,n,r,o={silent:!1}){const a=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let l=[e,s];n&&(l=l.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(l=e.split("."),r=s,s=l[1]),this.addNamespaces(s),Js(this.data,l,r),o.silent||this.emit("added",e,s,n,r)}addResources(e,s,n,r={silent:!1}){for(const o in n)(B(n[o])||Array.isArray(n[o]))&&this.addResource(e,s,o,n[o],{silent:!0});r.silent||this.emit("added",e,s,n)}addResourceBundle(e,s,n,r,o,a={silent:!1,skipCopy:!1}){let l=[e,s];e.indexOf(".")>-1&&(l=e.split("."),r=n,n=s,s=l[1]),this.addNamespaces(s);let d=lt(this.data,l)||{};a.skipCopy||(n=JSON.parse(JSON.stringify(n))),r?er(d,n,o):d={...d,...n},Js(this.data,l,d),a.silent||this.emit("added",e,s,n)}removeResourceBundle(e,s){this.hasResourceBundle(e,s)&&delete this.data[e][s],this.removeNamespaces(s),this.emit("removed",e,s)}hasResourceBundle(e,s){return this.getResource(e,s)!==void 0}getResourceBundle(e,s){return s||(s=this.options.defaultNS),this.getResource(e,s)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const s=this.getDataByLanguage(e);return!!(s&&Object.keys(s)||[]).find(r=>s[r]&&Object.keys(s[r]).length>0)}toJSON(){return this.data}}var tr={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,s,n,r){return t.forEach(o=>{var a;e=((a=this.processors[o])==null?void 0:a.process(e,s,n,r))??e}),e}};const sr=Symbol("i18next/PATH_KEY");function Fa(){const t=[],e=Object.create(null);let s;return e.get=(n,r)=>{var o;return(o=s==null?void 0:s.revoke)==null||o.call(s),r===sr?t:(t.push(r),s=Proxy.revocable(n,e),s.proxy)},Proxy.revocable(Object.create(null),e).proxy}function es(t,e){const{[sr]:s}=t(Fa());return s.join((e==null?void 0:e.keySeparator)??".")}const Ys={},Dt=t=>!B(t)&&typeof t!="boolean"&&typeof t!="number";class dt extends vt{constructor(e,s={}){super(),Na(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=s,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=de.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,s={interpolation:{}}){const n={...s};if(e==null)return!1;const r=this.resolve(e,n);if((r==null?void 0:r.res)===void 0)return!1;const o=Dt(r.res);return!(n.returnObjects===!1&&o)}extractFromKey(e,s){let n=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const r=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let o=s.ns||this.options.defaultNS||[];const a=n&&e.indexOf(n)>-1,l=!this.options.userDefinedKeySeparator&&!s.keySeparator&&!this.options.userDefinedNsSeparator&&!s.nsSeparator&&!Pa(e,n,r);if(a&&!l){const d=e.match(this.interpolator.nestingRegexp);if(d&&d.length>0)return{key:e,namespaces:B(o)?[o]:o};const c=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(r)}return{key:e,namespaces:B(o)?[o]:o}}translate(e,s,n){let r=typeof s=="object"?{...s}:s;if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),e==null)return"";typeof e=="function"&&(e=es(e,{...this.options,...r})),Array.isArray(e)||(e=[String(e)]);const o=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:l,namespaces:d}=this.extractFromKey(e[e.length-1],r),c=d[d.length-1];let u=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;u===void 0&&(u=":");const h=r.lng||this.language,v=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((h==null?void 0:h.toLowerCase())==="cimode")return v?o?{res:`${c}${u}${l}`,usedKey:l,exactUsedKey:l,usedLng:h,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:`${c}${u}${l}`:o?{res:l,usedKey:l,exactUsedKey:l,usedLng:h,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:l;const m=this.resolve(e,r);let f=m==null?void 0:m.res;const p=(m==null?void 0:m.usedKey)||l,x=(m==null?void 0:m.exactUsedKey)||l,N=["[object Number]","[object Function]","[object RegExp]"],j=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,E=!this.i18nFormat||this.i18nFormat.handleAsObject,T=r.count!==void 0&&!B(r.count),F=dt.hasDefaultValue(r),D=T?this.pluralResolver.getSuffix(h,r.count,r):"",$=r.ordinal&&T?this.pluralResolver.getSuffix(h,r.count,{ordinal:!1}):"",J=T&&!r.ordinal&&r.count===0,_=J&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${D}`]||r[`defaultValue${$}`]||r.defaultValue;let I=f;E&&!f&&F&&(I=_);const Q=Dt(I),k=Object.prototype.toString.apply(I);if(E&&I&&Q&&N.indexOf(k)<0&&!(B(j)&&Array.isArray(I))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const R=this.options.returnedObjectHandler?this.options.returnedObjectHandler(p,I,{...r,ns:d}):`key '${l} (${this.language})' returned an object instead of string.`;return o?(m.res=R,m.usedParams=this.getUsedParamsDetails(r),m):R}if(a){const R=Array.isArray(I),g=R?[]:{},S=R?x:p;for(const P in I)if(Object.prototype.hasOwnProperty.call(I,P)){const H=`${S}${a}${P}`;F&&!f?g[P]=this.translate(H,{...r,defaultValue:Dt(_)?_[P]:void 0,joinArrays:!1,ns:d}):g[P]=this.translate(H,{...r,joinArrays:!1,ns:d}),g[P]===H&&(g[P]=I[P])}f=g}}else if(E&&B(j)&&Array.isArray(f))f=f.join(j),f&&(f=this.extendTranslation(f,e,r,n));else{let R=!1,g=!1;!this.isValidLookup(f)&&F&&(R=!0,f=_),this.isValidLookup(f)||(g=!0,f=l);const P=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&g?void 0:f,H=F&&_!==f&&this.options.updateMissing;if(g||R||H){if(this.logger.log(H?"updateKey":"missingKey",h,c,l,H?_:f),a){const M=this.resolve(l,{...r,keySeparator:!1});M&&M.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let C=[];const K=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&K&&K[0])for(let M=0;M<K.length;M++)C.push(K[M]);else this.options.saveMissingTo==="all"?C=this.languageUtils.toResolveHierarchy(r.lng||this.language):C.push(r.lng||this.language);const q=(M,G,ne)=>{var ie;const W=F&&ne!==f?ne:P;this.options.missingKeyHandler?this.options.missingKeyHandler(M,c,G,W,H,r):(ie=this.backendConnector)!=null&&ie.saveMissing&&this.backendConnector.saveMissing(M,c,G,W,H,r),this.emit("missingKey",M,c,G,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&T?C.forEach(M=>{const G=this.pluralResolver.getSuffixes(M,r);J&&r[`defaultValue${this.options.pluralSeparator}zero`]&&G.indexOf(`${this.options.pluralSeparator}zero`)<0&&G.push(`${this.options.pluralSeparator}zero`),G.forEach(ne=>{q([M],l+ne,r[`defaultValue${ne}`]||_)})}):q(C,l,_))}f=this.extendTranslation(f,e,r,m,n),g&&f===l&&this.options.appendNamespaceToMissingKey&&(f=`${c}${u}${l}`),(g||R)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${u}${l}`:l,R?f:void 0,r))}return o?(m.res=f,m.usedParams=this.getUsedParamsDetails(r),m):f}extendTranslation(e,s,n,r,o){var d,c;if((d=this.i18nFormat)!=null&&d.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const u=B(e)&&(((c=n==null?void 0:n.interpolation)==null?void 0:c.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let h;if(u){const m=e.match(this.interpolator.nestingRegexp);h=m&&m.length}let v=n.replace&&!B(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(v={...this.options.interpolation.defaultVariables,...v}),e=this.interpolator.interpolate(e,v,n.lng||this.language||r.usedLng,n),u){const m=e.match(this.interpolator.nestingRegexp),f=m&&m.length;h<f&&(n.nest=!1)}!n.lng&&r&&r.res&&(n.lng=this.language||r.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,(...m)=>(o==null?void 0:o[0])===m[0]&&!n.context?(this.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${s[0]}`),null):this.translate(...m,s),n)),n.interpolation&&this.interpolator.reset()}const a=n.postProcess||this.options.postProcess,l=B(a)?[a]:a;return e!=null&&(l!=null&&l.length)&&n.applyPostProcessor!==!1&&(e=tr.handle(l,e,s,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,s={}){let n,r,o,a,l;return B(e)&&(e=[e]),e.forEach(d=>{if(this.isValidLookup(n))return;const c=this.extractFromKey(d,s),u=c.key;r=u;let h=c.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const v=s.count!==void 0&&!B(s.count),m=v&&!s.ordinal&&s.count===0,f=s.context!==void 0&&(B(s.context)||typeof s.context=="number")&&s.context!=="",p=s.lngs?s.lngs:this.languageUtils.toResolveHierarchy(s.lng||this.language,s.fallbackLng);h.forEach(x=>{var N,j;this.isValidLookup(n)||(l=x,!Ys[`${p[0]}-${x}`]&&((N=this.utils)!=null&&N.hasLoadedNamespace)&&!((j=this.utils)!=null&&j.hasLoadedNamespace(l))&&(Ys[`${p[0]}-${x}`]=!0,this.logger.warn(`key "${r}" for languages "${p.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(E=>{var D;if(this.isValidLookup(n))return;a=E;const T=[u];if((D=this.i18nFormat)!=null&&D.addLookupKeys)this.i18nFormat.addLookupKeys(T,u,E,x,s);else{let $;v&&($=this.pluralResolver.getSuffix(E,s.count,s));const J=`${this.options.pluralSeparator}zero`,_=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(v&&(s.ordinal&&$.indexOf(_)===0&&T.push(u+$.replace(_,this.options.pluralSeparator)),T.push(u+$),m&&T.push(u+J)),f){const I=`${u}${this.options.contextSeparator||"_"}${s.context}`;T.push(I),v&&(s.ordinal&&$.indexOf(_)===0&&T.push(I+$.replace(_,this.options.pluralSeparator)),T.push(I+$),m&&T.push(I+J))}}let F;for(;F=T.pop();)this.isValidLookup(n)||(o=F,n=this.getResource(E,x,F,s))}))})}),{res:n,usedKey:r,exactUsedKey:o,usedLng:a,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,s,n,r={}){var o;return(o=this.i18nFormat)!=null&&o.getResource?this.i18nFormat.getResource(e,s,n,r):this.resourceStore.getResource(e,s,n,r)}getUsedParamsDetails(e={}){const s=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!B(e.replace);let r=n?e.replace:e;if(n&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!n){r={...r};for(const o of s)delete r[o]}return r}static hasDefaultValue(e){const s="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&s===n.substring(0,s.length)&&e[n]!==void 0)return!0;return!1}}class Qs{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=de.create("languageUtils")}getScriptPartFromCode(e){if(e=Ue(e),!e||e.indexOf("-")<0)return null;const s=e.split("-");return s.length===2||(s.pop(),s[s.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(s.join("-"))}getLanguagePartFromCode(e){if(e=Ue(e),!e||e.indexOf("-")<0)return e;const s=e.split("-");return this.formatLanguageCode(s[0])}formatLanguageCode(e){if(B(e)&&e.indexOf("-")>-1){let s;try{s=Intl.getCanonicalLocales(e)[0]}catch{}return s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let s;return e.forEach(n=>{if(s)return;const r=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(r))&&(s=r)}),!s&&this.options.supportedLngs&&e.forEach(n=>{if(s)return;const r=this.getScriptPartFromCode(n);if(this.isSupportedCode(r))return s=r;const o=this.getLanguagePartFromCode(n);if(this.isSupportedCode(o))return s=o;s=this.options.supportedLngs.find(a=>{if(a===o)return a;if(!(a.indexOf("-")<0&&o.indexOf("-")<0)&&(a.indexOf("-")>0&&o.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===o||a.indexOf(o)===0&&o.length>1))return a})}),s||(s=this.getFallbackCodes(this.options.fallbackLng)[0]),s}getFallbackCodes(e,s){if(!e)return[];if(typeof e=="function"&&(e=e(s)),B(e)&&(e=[e]),Array.isArray(e))return e;if(!s)return e.default||[];let n=e[s];return n||(n=e[this.getScriptPartFromCode(s)]),n||(n=e[this.formatLanguageCode(s)]),n||(n=e[this.getLanguagePartFromCode(s)]),n||(n=e.default),n||[]}toResolveHierarchy(e,s){const n=this.getFallbackCodes((s===!1?[]:s)||this.options.fallbackLng||[],e),r=[],o=a=>{a&&(this.isSupportedCode(a)?r.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return B(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):B(e)&&o(this.formatLanguageCode(e)),n.forEach(a=>{r.indexOf(a)<0&&o(this.formatLanguageCode(a))}),r}}const Xs={zero:0,one:1,two:2,few:3,many:4,other:5},Zs={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Ia{constructor(e,s={}){this.languageUtils=e,this.options=s,this.logger=de.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(e,s={}){const n=Ue(e==="dev"?"en":e),r=s.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:r});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let a;try{a=new Intl.PluralRules(n,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Zs;if(!e.match(/-|_/))return Zs;const d=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(d,s)}return this.pluralRulesCache[o]=a,a}needsPlural(e,s={}){let n=this.getRule(e,s);return n||(n=this.getRule("dev",s)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,s,n={}){return this.getSuffixes(e,n).map(r=>`${s}${r}`)}getSuffixes(e,s={}){let n=this.getRule(e,s);return n||(n=this.getRule("dev",s)),n?n.resolvedOptions().pluralCategories.sort((r,o)=>Xs[r]-Xs[o]).map(r=>`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${r}`):[]}getSuffix(e,s,n={}){const r=this.getRule(e,n);return r?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r.select(s)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",s,n))}}const en=(t,e,s,n=".",r=!0)=>{let o=Ea(t,e,s);return!o&&r&&B(s)&&(o=Zt(t,s,n),o===void 0&&(o=Zt(e,s,n))),o},Mt=t=>t.replace(/\$/g,"$$$$");class tn{constructor(e={}){var s;this.logger=de.create("interpolator"),this.options=e,this.format=((s=e==null?void 0:e.interpolation)==null?void 0:s.format)||(n=>n),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:s,escapeValue:n,useRawValueToEscape:r,prefix:o,prefixEscaped:a,suffix:l,suffixEscaped:d,formatSeparator:c,unescapeSuffix:u,unescapePrefix:h,nestingPrefix:v,nestingPrefixEscaped:m,nestingSuffix:f,nestingSuffixEscaped:p,nestingOptionsSeparator:x,maxReplaces:N,alwaysFormat:j}=e.interpolation;this.escape=s!==void 0?s:Oa,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=o?ke(o):a||"{{",this.suffix=l?ke(l):d||"}}",this.formatSeparator=c||",",this.unescapePrefix=u?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=v?ke(v):m||ke("$t("),this.nestingSuffix=f?ke(f):p||ke(")"),this.nestingOptionsSeparator=x||",",this.maxReplaces=N||1e3,this.alwaysFormat=j!==void 0?j:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(s,n)=>(s==null?void 0:s.source)===n?(s.lastIndex=0,s):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,s,n,r){var m;let o,a,l;const d=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=f=>{if(f.indexOf(this.formatSeparator)<0){const j=en(s,d,f,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(j,void 0,n,{...r,...s,interpolationkey:f}):j}const p=f.split(this.formatSeparator),x=p.shift().trim(),N=p.join(this.formatSeparator).trim();return this.format(en(s,d,x,this.options.keySeparator,this.options.ignoreJSONStructure),N,n,{...r,...s,interpolationkey:x})};this.resetRegExp();const u=(r==null?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,h=((m=r==null?void 0:r.interpolation)==null?void 0:m.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:f=>Mt(f)},{regex:this.regexp,safeValue:f=>this.escapeValue?Mt(this.escape(f)):Mt(f)}].forEach(f=>{for(l=0;o=f.regex.exec(e);){const p=o[1].trim();if(a=c(p),a===void 0)if(typeof u=="function"){const N=u(e,o,r);a=B(N)?N:""}else if(r&&Object.prototype.hasOwnProperty.call(r,p))a="";else if(h){a=o[0];continue}else this.logger.warn(`missed to pass in variable ${p} for interpolating ${e}`),a="";else!B(a)&&!this.useRawValueToEscape&&(a=Ks(a));const x=f.safeValue(a);if(e=e.replace(o[0],x),h?(f.regex.lastIndex+=a.length,f.regex.lastIndex-=o[0].length):f.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,s,n={}){let r,o,a;const l=(d,c)=>{const u=this.nestingOptionsSeparator;if(d.indexOf(u)<0)return d;const h=d.split(new RegExp(`${u}[ ]*{`));let v=`{${h[1]}`;d=h[0],v=this.interpolate(v,a);const m=v.match(/'/g),f=v.match(/"/g);(((m==null?void 0:m.length)??0)%2===0&&!f||f.length%2!==0)&&(v=v.replace(/'/g,'"'));try{a=JSON.parse(v),c&&(a={...c,...a})}catch(p){return this.logger.warn(`failed parsing options string in nesting for key ${d}`,p),`${d}${u}${v}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,d};for(;r=this.nestingRegexp.exec(e);){let d=[];a={...n},a=a.replace&&!B(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;const c=/{.*}/.test(r[1])?r[1].lastIndexOf("}")+1:r[1].indexOf(this.formatSeparator);if(c!==-1&&(d=r[1].slice(c).split(this.formatSeparator).map(u=>u.trim()).filter(Boolean),r[1]=r[1].slice(0,c)),o=s(l.call(this,r[1].trim(),a),a),o&&r[0]===e&&!B(o))return o;B(o)||(o=Ks(o)),o||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),o=""),d.length&&(o=d.reduce((u,h)=>this.format(u,h,n.lng,{...n,interpolationkey:r[1].trim()}),o.trim())),e=e.replace(r[0],o),this.regexp.lastIndex=0}return e}}const Ba=t=>{let e=t.toLowerCase().trim();const s={};if(t.indexOf("(")>-1){const n=t.split("(");e=n[0].toLowerCase().trim();const r=n[1].substring(0,n[1].length-1);e==="currency"&&r.indexOf(":")<0?s.currency||(s.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?s.range||(s.range=r.trim()):r.split(";").forEach(a=>{if(a){const[l,...d]=a.split(":"),c=d.join(":").trim().replace(/^'+|'+$/g,""),u=l.trim();s[u]||(s[u]=c),c==="false"&&(s[u]=!1),c==="true"&&(s[u]=!0),isNaN(c)||(s[u]=parseInt(c,10))}})}return{formatName:e,formatOptions:s}},sn=t=>{const e={};return(s,n,r)=>{let o=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(o={...o,[r.interpolationkey]:void 0});const a=n+JSON.stringify(o);let l=e[a];return l||(l=t(Ue(n),r),e[a]=l),l(s)}},$a=t=>(e,s,n)=>t(Ue(s),n)(e);class _a{constructor(e={}){this.logger=de.create("formatter"),this.options=e,this.init(e)}init(e,s={interpolation:{}}){this.formatSeparator=s.interpolation.formatSeparator||",";const n=s.cacheInBuiltFormats?sn:$a;this.formats={number:n((r,o)=>{const a=new Intl.NumberFormat(r,{...o});return l=>a.format(l)}),currency:n((r,o)=>{const a=new Intl.NumberFormat(r,{...o,style:"currency"});return l=>a.format(l)}),datetime:n((r,o)=>{const a=new Intl.DateTimeFormat(r,{...o});return l=>a.format(l)}),relativetime:n((r,o)=>{const a=new Intl.RelativeTimeFormat(r,{...o});return l=>a.format(l,o.range||"day")}),list:n((r,o)=>{const a=new Intl.ListFormat(r,{...o});return l=>a.format(l)})}}add(e,s){this.formats[e.toLowerCase().trim()]=s}addCached(e,s){this.formats[e.toLowerCase().trim()]=sn(s)}format(e,s,n,r={}){const o=s.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(l=>l.indexOf(")")>-1)){const l=o.findIndex(d=>d.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,l)].join(this.formatSeparator)}return o.reduce((l,d)=>{var h;const{formatName:c,formatOptions:u}=Ba(d);if(this.formats[c]){let v=l;try{const m=((h=r==null?void 0:r.formatParams)==null?void 0:h[r.interpolationkey])||{},f=m.locale||m.lng||r.locale||r.lng||n;v=this.formats[c](l,f,{...u,...r,...m})}catch(m){this.logger.warn(m)}return v}else this.logger.warn(`there was no format function for ${c}`);return l},e)}}const Da=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class Ma extends vt{constructor(e,s,n,r={}){var o,a;super(),this.backend=e,this.store=s,this.services=n,this.languageUtils=n.languageUtils,this.options=r,this.logger=de.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],(a=(o=this.backend)==null?void 0:o.init)==null||a.call(o,n,r.backend,r)}queueLoad(e,s,n,r){const o={},a={},l={},d={};return e.forEach(c=>{let u=!0;s.forEach(h=>{const v=`${c}|${h}`;!n.reload&&this.store.hasResourceBundle(c,h)?this.state[v]=2:this.state[v]<0||(this.state[v]===1?a[v]===void 0&&(a[v]=!0):(this.state[v]=1,u=!1,a[v]===void 0&&(a[v]=!0),o[v]===void 0&&(o[v]=!0),d[h]===void 0&&(d[h]=!0)))}),u||(l[c]=!0)}),(Object.keys(o).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(o),pending:Object.keys(a),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(d)}}loaded(e,s,n){const r=e.split("|"),o=r[0],a=r[1];s&&this.emit("failedLoading",o,a,s),!s&&n&&this.store.addResourceBundle(o,a,n,void 0,void 0,{skipCopy:!0}),this.state[e]=s?-1:2,s&&n&&(this.state[e]=0);const l={};this.queue.forEach(d=>{Sa(d.loaded,[o],a),Da(d,e),s&&d.errors.push(s),d.pendingCount===0&&!d.done&&(Object.keys(d.loaded).forEach(c=>{l[c]||(l[c]={});const u=d.loaded[c];u.length&&u.forEach(h=>{l[c][h]===void 0&&(l[c][h]=!0)})}),d.done=!0,d.errors.length?d.callback(d.errors):d.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(d=>!d.done)}read(e,s,n,r=0,o=this.retryTimeout,a){if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:s,fcName:n,tried:r,wait:o,callback:a});return}this.readingCalls++;const l=(c,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const h=this.waitingReads.shift();this.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(c&&u&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,s,n,r+1,o*2,a)},o);return}a(c,u)},d=this.backend[n].bind(this.backend);if(d.length===2){try{const c=d(e,s);c&&typeof c.then=="function"?c.then(u=>l(null,u)).catch(l):l(null,c)}catch(c){l(c)}return}return d(e,s,l)}prepareLoading(e,s,n={},r){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();B(e)&&(e=this.languageUtils.toResolveHierarchy(e)),B(s)&&(s=[s]);const o=this.queueLoad(e,s,n,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach(a=>{this.loadOne(a)})}load(e,s,n){this.prepareLoading(e,s,{},n)}reload(e,s,n){this.prepareLoading(e,s,{reload:!0},n)}loadOne(e,s=""){const n=e.split("|"),r=n[0],o=n[1];this.read(r,o,"read",void 0,void 0,(a,l)=>{a&&this.logger.warn(`${s}loading namespace ${o} for language ${r} failed`,a),!a&&l&&this.logger.log(`${s}loaded namespace ${o} for language ${r}`,l),this.loaded(e,a,l)})}saveMissing(e,s,n,r,o,a={},l=()=>{}){var d,c,u,h,v;if((c=(d=this.services)==null?void 0:d.utils)!=null&&c.hasLoadedNamespace&&!((h=(u=this.services)==null?void 0:u.utils)!=null&&h.hasLoadedNamespace(s))){this.logger.warn(`did not save key "${n}" as the namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((v=this.backend)!=null&&v.create){const m={...a,isUpdate:o},f=this.backend.create.bind(this.backend);if(f.length<6)try{let p;f.length===5?p=f(e,s,n,r,m):p=f(e,s,n,r),p&&typeof p.then=="function"?p.then(x=>l(null,x)).catch(l):l(null,p)}catch(p){l(p)}else f(e,s,n,r,l,m)}!e||!e[0]||this.store.addResource(e[0],s,n,r)}}}const Ut=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),B(t[1])&&(e.defaultValue=t[1]),B(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const s=t[3]||t[2];Object.keys(s).forEach(n=>{e[n]=s[n]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),nn=t=>{var e,s;return B(t.ns)&&(t.ns=[t.ns]),B(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),B(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((s=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:s.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},st=()=>{},Ua=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(s=>{typeof t[s]=="function"&&(t[s]=t[s].bind(t))})};class De extends vt{constructor(e={},s){if(super(),this.options=nn(e),this.services={},this.logger=de,this.modules={external:[]},Ua(this),s&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,s),this;setTimeout(()=>{this.init(e,s)},0)}}init(e={},s){this.isInitializing=!0,typeof e=="function"&&(s=e,e={}),e.defaultNS==null&&e.ns&&(B(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=Ut();this.options={...n,...this.options,...nn(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=n.overloadTranslationOptionHandler),this.options.debug===!0&&typeof console<"u"&&console.warn("i18next is maintained with support from locize.com  consider powering your project with managed localization (AI, CDN, integrations): https://locize.com");const r=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?de.init(r(this.modules.logger),this.options):de.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=_a;const u=new Qs(this.options);this.store=new Gs(this.options.resources,this.options);const h=this.services;h.logger=de,h.resourceStore=this.store,h.languageUtils=u,h.pluralResolver=new Ia(u,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),c&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(h.formatter=r(c),h.formatter.init&&h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new tn(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new Ma(r(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",(m,...f)=>{this.emit(m,...f)}),this.modules.languageDetector&&(h.languageDetector=r(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=r(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new dt(this.services,this.options),this.translator.on("*",(m,...f)=>{this.emit(m,...f)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,s||(s=st),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=(...u)=>this.store[c](...u)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=(...u)=>(this.store[c](...u),this)});const l=$e(),d=()=>{const c=(u,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(h),s(u,h)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),l}loadResources(e,s=st){var o,a;let n=s;const r=B(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if((r==null?void 0:r.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const l=[],d=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(h=>{h!=="cimode"&&l.indexOf(h)<0&&l.push(h)})};r?d(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>d(u)),(a=(o=this.options.preload)==null?void 0:o.forEach)==null||a.call(o,c=>d(c)),this.services.backendConnector.load(l,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(c)})}else n(null)}reloadResources(e,s,n){const r=$e();return typeof e=="function"&&(n=e,e=void 0),typeof s=="function"&&(n=s,s=void 0),e||(e=this.languages),s||(s=this.options.ns),n||(n=st),this.services.backendConnector.reload(e,s,o=>{r.resolve(),n(o)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&tr.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let s=0;s<this.languages.length;s++){const n=this.languages[s];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,s){this.isLanguageChangingTo=e;const n=$e();this.emit("languageChanging",e);const r=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,d)=>{d?this.isLanguageChangingTo===e&&(r(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,n.resolve((...c)=>this.t(...c)),s&&s(l,(...c)=>this.t(...c))},a=l=>{var u,h;!e&&!l&&this.services.languageDetector&&(l=[]);const d=B(l)?l:l&&l[0],c=this.store.hasLanguageSomeTranslations(d)?d:this.services.languageUtils.getBestMatchFromCodes(B(l)?[l]:l);c&&(this.language||r(c),this.translator.language||this.translator.changeLanguage(c),(h=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||h.call(u,c)),this.loadResources(c,v=>{o(v,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),n}getFixedT(e,s,n){const r=(o,a,...l)=>{let d;typeof a!="object"?d=this.options.overloadTranslationOptionHandler([o,a].concat(l)):d={...a},d.lng=d.lng||r.lng,d.lngs=d.lngs||r.lngs,d.ns=d.ns||r.ns,d.keyPrefix!==""&&(d.keyPrefix=d.keyPrefix||n||r.keyPrefix);const c=this.options.keySeparator||".";let u;return d.keyPrefix&&Array.isArray(o)?u=o.map(h=>(typeof h=="function"&&(h=es(h,{...this.options,...a})),`${d.keyPrefix}${c}${h}`)):(typeof o=="function"&&(o=es(o,{...this.options,...a})),u=d.keyPrefix?`${d.keyPrefix}${c}${o}`:o),this.t(u,d)};return B(e)?r.lng=e:r.lngs=e,r.ns=s,r.keyPrefix=n,r}t(...e){var s;return(s=this.translator)==null?void 0:s.translate(...e)}exists(...e){var s;return(s=this.translator)==null?void 0:s.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,s={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=s.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const a=(l,d)=>{const c=this.services.backendConnector.state[`${l}|${d}`];return c===-1||c===0||c===2};if(s.precheck){const l=s.precheck(this,a);if(l!==void 0)return l}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(n,e)&&(!r||a(o,e)))}loadNamespaces(e,s){const n=$e();return this.options.ns?(B(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{n.resolve(),s&&s(r)}),n):(s&&s(),Promise.resolve())}loadLanguages(e,s){const n=$e();B(e)&&(e=[e]);const r=this.options.preload||[],o=e.filter(a=>r.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return o.length?(this.options.preload=r.concat(o),this.loadResources(a=>{n.resolve(),s&&s(a)}),n):(s&&s(),Promise.resolve())}dir(e){var r,o;if(e||(e=this.resolvedLanguage||(((r=this.languages)==null?void 0:r.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const a=new Intl.Locale(e);if(a&&a.getTextInfo){const l=a.getTextInfo();if(l&&l.direction)return l.direction}}catch{}const s=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((o=this.services)==null?void 0:o.languageUtils)||new Qs(Ut());return e.toLowerCase().indexOf("-latn")>1?"ltr":s.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},s){const n=new De(e,s);return n.createInstance=De.createInstance,n}cloneInstance(e={},s=st){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},o=new De(r);if((e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(l=>{o[l]=this[l]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n){const l=Object.keys(this.store.data).reduce((d,c)=>(d[c]={...this.store.data[c]},d[c]=Object.keys(d[c]).reduce((u,h)=>(u[h]={...d[c][h]},u),d[c]),d),{});o.store=new Gs(l,r),o.services.resourceStore=o.store}if(e.interpolation){const d={...Ut().interpolation,...this.options.interpolation,...e.interpolation},c={...r,interpolation:d};o.services.interpolator=new tn(c)}return o.translator=new dt(o.services,r),o.translator.on("*",(l,...d)=>{o.emit(l,...d)}),o.init(r,s),o.translator.options=r,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Z=De.createInstance();Z.createInstance;Z.dir;Z.init;Z.loadResources;Z.reloadResources;Z.use;Z.changeLanguage;Z.getFixedT;Z.t;Z.exists;Z.setDefaultNamespace;Z.hasLoadedNamespace;Z.loadNamespaces;Z.loadLanguages;const Ha=(t,e,s,n)=>{var o,a,l,d;const r=[s,{code:e,...n||{}}];if((a=(o=t==null?void 0:t.services)==null?void 0:o.logger)!=null&&a.forward)return t.services.logger.forward(r,"warn","react-i18next::",!0);we(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(d=(l=t==null?void 0:t.services)==null?void 0:l.logger)!=null&&d.warn?t.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},rn={},nr=(t,e,s,n)=>{we(s)&&rn[s]||(we(s)&&(rn[s]=new Date),Ha(t,e,s,n))},rr=(t,e)=>()=>{if(t.isInitialized)e();else{const s=()=>{setTimeout(()=>{t.off("initialized",s)},0),e()};t.on("initialized",s)}},ts=(t,e,s)=>{t.loadNamespaces(e,rr(t,s))},on=(t,e,s,n)=>{if(we(s)&&(s=[s]),t.options.preload&&t.options.preload.indexOf(e)>-1)return ts(t,s,n);s.forEach(r=>{t.options.ns.indexOf(r)<0&&t.options.ns.push(r)}),t.loadLanguages(e,rr(t,n))},za=(t,e,s={})=>!e.languages||!e.languages.length?(nr(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:s.lng,precheck:(n,r)=>{if(s.bindI18n&&s.bindI18n.indexOf("languageChanging")>-1&&n.services.backendConnector.backend&&n.isLanguageChangingTo&&!r(n.isLanguageChangingTo,t))return!1}}),we=t=>typeof t=="string",Va=t=>typeof t=="object"&&t!==null,Ka=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Wa={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},qa=t=>Wa[t],Ja=t=>t.replace(Ka,qa);let ss={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Ja,transDefaultProps:void 0};const Ga=(t={})=>{ss={...ss,...t}},Ya=()=>ss;let or;const Qa=t=>{or=t},Xa=()=>or,Za={type:"3rdParty",init(t){Ga(t.options.react),Qa(t)}},el=b.createContext();class tl{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(s=>{this.usedNamespaces[s]||(this.usedNamespaces[s]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const sl=(t,e)=>we(e)?e:Va(e)&&we(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,nl={t:sl,ready:!1},rl=()=>()=>{},ee=(t,e={})=>{var _,I,Q;const{i18n:s}=e,{i18n:n,defaultNS:r}=b.useContext(el)||{},o=s||n||Xa();o&&!o.reportNamespaces&&(o.reportNamespaces=new tl),o||nr(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const a=b.useMemo(()=>{var k;return{...Ya(),...(k=o==null?void 0:o.options)==null?void 0:k.react,...e}},[o,e]),{useSuspense:l,keyPrefix:d}=a,c=r||((_=o==null?void 0:o.options)==null?void 0:_.defaultNS),u=we(c)?[c]:c||["translation"],h=b.useMemo(()=>u,u);(Q=(I=o==null?void 0:o.reportNamespaces)==null?void 0:I.addUsedNamespaces)==null||Q.call(I,h);const v=b.useRef(0),m=b.useCallback(k=>{if(!o)return rl;const{bindI18n:R,bindI18nStore:g}=a,S=()=>{v.current+=1,k()};return R&&o.on(R,S),g&&o.store.on(g,S),()=>{R&&R.split(" ").forEach(P=>o.off(P,S)),g&&g.split(" ").forEach(P=>o.store.off(P,S))}},[o,a]),f=b.useRef(),p=b.useCallback(()=>{if(!o)return nl;const k=!!(o.isInitialized||o.initializedStoreOnce)&&h.every(C=>za(C,o,a)),R=e.lng||o.language,g=v.current,S=f.current;if(S&&S.ready===k&&S.lng===R&&S.keyPrefix===d&&S.revision===g)return S;const H={t:o.getFixedT(R,a.nsMode==="fallback"?h:h[0],d),ready:k,lng:R,keyPrefix:d,revision:g};return f.current=H,H},[o,h,d,a,e.lng]),[x,N]=b.useState(0),{t:j,ready:E}=jn.useSyncExternalStore(m,p,p);b.useEffect(()=>{if(o&&!E&&!l){const k=()=>N(R=>R+1);e.lng?on(o,e.lng,h,k):ts(o,h,k)}},[o,e.lng,h,E,l,x]);const T=o||{},F=b.useRef(null),D=b.useRef(),$=k=>{const R=Object.getOwnPropertyDescriptors(k);R.__original&&delete R.__original;const g=Object.create(Object.getPrototypeOf(k),R);if(!Object.prototype.hasOwnProperty.call(g,"__original"))try{Object.defineProperty(g,"__original",{value:k,writable:!1,enumerable:!1,configurable:!1})}catch{}return g},J=b.useMemo(()=>{const k=T,R=k==null?void 0:k.language;let g=k;k&&(F.current&&F.current.__original===k?D.current!==R?(g=$(k),F.current=g,D.current=R):g=F.current:(g=$(k),F.current=g,D.current=R));const S=[j,g,E];return S.t=j,S.i18n=g,S.ready=E,S},[j,T,E,T.resolvedLanguage,T.language,T.languages]);if(o&&l&&!E)throw new Promise(k=>{const R=()=>k();e.lng?on(o,e.lng,h,R):ts(o,h,R)});return J};function ol({activeCategory:t,onCategoryChange:e}){const{t:s}=ee(),n=[{value:"adult",labelKey:"categories.adult"},{value:"kids",labelKey:"categories.kids"}];return i.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide",children:n.map(r=>{const o=t===r.value;return i.jsx("button",{onClick:()=>e(r.value),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all duration-150
              ${o?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:s(r.labelKey)},r.value)})})}function wt(t){return i.jsx("header",{className:"bg-gray-800 shadow-lg fixed top-0 w-full z-50",children:t.children})}function jt(t){return i.jsx("main",{className:`max-w-7xl mx-auto px-4 py-8 ${t.className||""}`,children:t.children})}function He(t){const e=Math.floor(t/3600),s=Math.floor(t%3600/60),n=Math.floor(t%60);return e>0?`${e}:${s.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${s}:${n.toString().padStart(2,"0")}`}function ir(t){const e=new Date(t),n=new Date().getTime()-e.getTime(),r=Math.floor(n/(1e3*60)),o=Math.floor(n/(1e3*60*60)),a=Math.floor(n/(1e3*60*60*24));return r<1?"Just now":r<60?`${r}m ago`:o<24?`${o}h ago`:a<7?`${a}d ago`:e.toLocaleDateString()}function il(t){const e=Math.floor(t/60),s=t%60;return`${e}:${s.toString().padStart(2,"0")}`}function Le(t,e){return e?`${Pe()}/books/${t}/cover`:null}function al(){const{t}=ee(),[e,s]=b.useState([]),[n,r]=b.useState(new Map),[o,a]=b.useState(!0),[l,d]=b.useState(!1),[c,u]=b.useState(""),[h,v]=b.useState(!0),[m,f]=b.useState(1),{user:p}=oe(),{bookId:x}=qe(),N=(p==null?void 0:p.user_type)==="kid",[j,E]=b.useState(N?"kids":"adult"),T=!!x,F=b.useRef(null),D=b.useRef(null),$=20;b.useEffect(()=>{s([]),f(1),v(!0),a(!0)},[j]),b.useEffect(()=>{J(m,j,m===1)},[m,j]),b.useEffect(()=>{_()},[]);const J=async(k,R,g)=>{var S,P;g?a(!0):d(!0);try{const H=`/books?page=${k}&limit=${$}&bookType=${R}`,C=await V.get(H),{books:K,hasMore:q}=C.data.data;s(g?K:M=>[...M,...K]),v(q)}catch(H){u(((P=(S=H.response)==null?void 0:S.data)==null?void 0:P.error)||"Failed to load books")}finally{a(!1),d(!1)}},_=async()=>{try{const R=(await V.get("/history")).data.data,g=new Map;R.forEach(S=>g.set(S.book_id,S)),r(g)}catch(k){console.error("Failed to fetch history:",k)}},I=b.useCallback(()=>{!l&&h&&f(k=>k+1)},[l,h]);b.useEffect(()=>(F.current&&F.current.disconnect(),F.current=new IntersectionObserver(k=>{k[0].isIntersecting&&h&&!o&&!l&&I()},{rootMargin:"200px"}),D.current&&F.current.observe(D.current),()=>{F.current&&F.current.disconnect()}),[h,o,l,I]);const Q=k=>n.get(k)||null;return i.jsxs("div",{className:`min-h-screen ${T?"pb-40":"pb-24"}`,children:[i.jsx(wt,{children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[i.jsx("h1",{className:"text-2xl font-bold text-indigo-400",children:t("home.title")}),i.jsx("span",{className:"text-gray-300 text-sm",children:(p==null?void 0:p.display_name)||(p==null?void 0:p.email)})]})}),i.jsxs(jt,{className:N?"pt-[80px]":"pt-16",children:[!N&&i.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:i.jsx(ol,{activeCategory:j,onCategoryChange:E})}),o?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):c?i.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded",children:c}):e.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("p",{className:"text-gray-400 text-lg",children:t("home.noCategoryBooks",{category:t(`categories.${j}`)})}),(p==null?void 0:p.role)==="admin"&&i.jsx(ae,{to:"/admin",className:"mt-4 inline-block px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded",children:t("home.uploadFirst")})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-6",children:e.map(k=>{const R=Q(k.id);return i.jsxs(ae,{to:`/player/${k.id}`,className:"group bg-gray-800 rounded-xl overflow-hidden hover:bg-gray-750 hover:ring-2 hover:ring-indigo-500/50 transition-all duration-150 hover:scale-[1.02]",children:[i.jsxs("div",{className:"aspect-square bg-gray-700 flex items-center justify-center relative",children:[k.cover_url?i.jsx("img",{src:Le(k.id,!!k.cover_url)||"",alt:k.title,className:"w-full h-full object-cover"}):i.jsx("span",{className:"text-6xl",children:""}),R&&i.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-indigo-500 rounded-full shadow-lg"}),i.jsx("div",{className:`absolute bottom-2 left-2 px-2 py-0.5 rounded-full text-xs font-medium
                        ${k.book_type==="kids"?"bg-green-600/80 text-white":"bg-gray-900/80 text-gray-200"}`,children:t(`categories.${k.book_type==="kids"?"kids":"adult"}`)})]}),i.jsxs("div",{className:"p-3 sm:p-4",children:[i.jsx("h3",{className:"font-semibold text-white group-hover:text-indigo-400 text-sm sm:text-base line-clamp-2 h-10 sm:h-12",children:k.title}),k.author&&i.jsx("p",{className:"text-xs sm:text-sm text-gray-400 truncate",children:k.author}),R?i.jsxs("div",{className:"mt-2 text-xs",children:[i.jsxs("p",{className:"text-indigo-400",children:[t("common.episodeAbbr")," ",R.episode_index+1,"/",k.episode_count,"  ",He(R.current_time_seconds)]}),i.jsx("p",{className:"text-gray-500",children:ir(R.last_played_at)})]}):i.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[k.episode_count," ",t("common.episodes")]})]})]},k.id)})}),i.jsx("div",{ref:D,className:"h-20 flex items-center justify-center",children:l&&i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})})]})]})]})}function ll(){const{t}=ee(),[e,s]=b.useState(""),[n,r]=b.useState(""),[o,a]=b.useState(""),[l,d]=b.useState(!1),{setAuth:c,logout:u}=oe(),h=ut(),v=async m=>{var f,p;m.preventDefault(),a(""),d(!0);try{u();const x=await V.post("/auth/login",{email:e,password:n}),{user:N,accessToken:j,refreshToken:E}=x.data.data;c(N,j,E),h("/")}catch(x){a(((p=(f=x.response)==null?void 0:f.data)==null?void 0:p.error)||t("auth.loginFailed"))}finally{d(!1)}};return i.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("h1",{className:"text-3xl font-bold text-indigo-400",children:[" ",t("common.appName")]}),i.jsx("p",{className:"mt-2 text-gray-400",children:t("auth.signInToAccount")})]}),i.jsxs("form",{onSubmit:v,className:"mt-8 space-y-6",children:[o&&i.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded",children:o}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:t("auth.email")}),i.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:m=>s(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:t("auth.emailPlaceholder")})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:t("auth.password")}),i.jsx("input",{id:"password",type:"password",required:!0,value:n,onChange:m=>r(m.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:t("auth.passwordPlaceholder")})]})]}),i.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t(l?"auth.signingIn":"auth.signIn")}),i.jsxs("p",{className:"text-center text-sm text-gray-400",children:[t("auth.noAccount")," ",i.jsx(ae,{to:"/register",className:"text-indigo-400 hover:text-indigo-300",children:t("auth.register")})]})]})]})})}function cl(){const{t}=ee(),[e,s]=b.useState(""),[n,r]=b.useState(""),[o,a]=b.useState(""),[l,d]=b.useState("adult"),[c,u]=b.useState(""),[h,v]=b.useState(!1),{setAuth:m}=oe(),f=ut(),p=async x=>{var N,j;x.preventDefault(),u(""),v(!0);try{const E=await V.post("/auth/register",{email:e,password:n,display_name:o,user_type:l}),{user:T,accessToken:F,refreshToken:D}=E.data.data;m(T,F,D),f("/")}catch(E){u(((j=(N=E.response)==null?void 0:N.data)==null?void 0:j.error)||t("auth.registrationFailed"))}finally{v(!1)}};return i.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("h1",{className:"text-3xl font-bold text-indigo-400",children:[" ",t("common.appName")]}),i.jsx("p",{className:"mt-2 text-gray-400",children:t("auth.createYourAccount")})]}),i.jsxs("form",{onSubmit:p,className:"mt-8 space-y-6",children:[c&&i.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded",children:c}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-300",children:t("auth.displayName")}),i.jsx("input",{id:"displayName",type:"text",value:o,onChange:x=>a(x.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:t("auth.displayNamePlaceholder")})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:t("auth.email")}),i.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:x=>s(x.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:t("auth.emailPlaceholder")})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:t("auth.password")}),i.jsx("input",{id:"password",type:"password",required:!0,minLength:8,value:n,onChange:x=>r(x.target.value),className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:t("auth.passwordPlaceholder")})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("auth.accountType")}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"userType",value:"adult",checked:l==="adult",onChange:()=>d("adult"),className:"mr-2"}),i.jsx("span",{className:"text-gray-300",children:t("auth.adult")})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",name:"userType",value:"kid",checked:l==="kid",onChange:()=>d("kid"),className:"mr-2"}),i.jsx("span",{className:"text-gray-300",children:t("auth.kid")})]})]})]})]}),i.jsx("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t(h?"auth.creatingAccount":"auth.createAccount")}),i.jsxs("p",{className:"text-center text-sm text-gray-400",children:[t("auth.hasAccount")," ",i.jsx(ae,{to:"/login",className:"text-indigo-400 hover:text-indigo-300",children:t("auth.signIn")})]})]})]})})}function as({className:t="w-8 h-8"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M8 5v14l11-7z"})})}function ar({className:t="w-8 h-8"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})})}function dl({className:t="w-6 h-6"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"})})}function ul({className:t="w-6 h-6"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"})})}function hl({className:t="w-7 h-7"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z"})})}function fl({className:t="w-7 h-7"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"})})}function pl({className:t="w-6 h-6"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"})})}function an({className:t="w-6 h-6"}){return i.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}function lr({className:t="w-6 h-6"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})}function cr({className:t="w-5 h-5"}){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:t,children:i.jsx("path",{d:"M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})})}function ml({coverUrl:t,isPlaying:e,title:s}){return i.jsxs("div",{className:"relative flex items-center justify-center",children:[i.jsx("div",{className:"absolute w-64 h-64 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 shadow-2xl"}),i.jsx("div",{className:"absolute w-60 h-60 rounded-full border-4 border-gray-700/50"}),i.jsx("div",{className:"absolute w-52 h-52 rounded-full border-2 border-gray-700/30"}),i.jsx("div",{className:"absolute w-44 h-44 rounded-full border border-gray-700/20"}),i.jsxs("div",{className:`relative w-40 h-40 rounded-full overflow-hidden shadow-lg border-4 border-gray-600 ${e?"animate-spin-slow":""}`,style:{animationDuration:"8s"},children:[t?i.jsx("img",{src:t,alt:s,className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center",children:i.jsx("span",{className:"text-4xl",children:""})}),i.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-6 h-6 rounded-full bg-gray-900 border-2 border-gray-700"})]})]})}function gl({isOpen:t,onClose:e,episodes:s,currentEpisode:n,onSelectEpisode:r,bookTitle:o}){const{t:a}=ee();return t?i.jsx("div",{className:"fixed inset-0 z-50 bg-gray-900/95 backdrop-blur-sm",children:i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-white",children:a("common.episodes")}),i.jsx("p",{className:"text-sm text-gray-400",children:o})]}),i.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",children:i.jsx(lr,{})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsx("div",{className:"space-y-2",children:s.map((l,d)=>i.jsx("button",{onClick:()=>{r(d),e()},className:`w-full text-left px-4 py-4 rounded-xl transition-all ${d===n?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${d===n?"bg-white/20":"bg-gray-700"}`,children:d+1}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium truncate",children:l.title||`${a("common.episode")} ${d+1}`}),l.duration&&l.duration>0&&i.jsxs("p",{className:"text-sm opacity-70",children:[Math.floor(l.duration/60),":",String(l.duration%60).padStart(2,"0")]})]}),d===n&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"w-1 h-3 bg-white rounded-full animate-pulse"}),i.jsx("span",{className:"w-1 h-4 bg-white rounded-full animate-pulse delay-75"}),i.jsx("span",{className:"w-1 h-2 bg-white rounded-full animate-pulse delay-150"})]})]})},d))})})]})}):null}const xl=[5,10,15,20,30,45,60];function yl({isOpen:t,onClose:e,activeTimer:s,remainingTime:n,onSetTimer:r,onCancelTimer:o}){const{t:a}=ee();return t?i.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-end sm:items-center justify-center",children:i.jsxs("div",{className:"bg-gray-800 rounded-t-3xl sm:rounded-2xl w-full sm:max-w-sm p-6 animate-slide-up",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[i.jsx(cr,{}),a("player.sleepTimer")]}),i.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-700 text-gray-400 hover:text-white transition-colors",children:i.jsx(lr,{})})]}),s!==null&&i.jsxs("div",{className:"mb-6 p-4 bg-indigo-600/20 border border-indigo-500/30 rounded-xl",children:[i.jsx("p",{className:"text-indigo-300 text-sm mb-1",children:a("player.timerActive")}),i.jsx("p",{className:"text-3xl font-bold text-white",children:il(n)}),i.jsx("button",{onClick:()=>{o(),e()},className:"mt-3 w-full py-2 bg-red-600/20 hover:bg-red-600/30 border border-red-500/30 rounded-lg text-red-400 text-sm transition-colors",children:a("player.cancelTimer")})]}),i.jsx("div",{className:"grid grid-cols-3 gap-3",children:xl.map(l=>i.jsxs("button",{onClick:()=>{r(l),e()},className:`py-4 rounded-xl text-center transition-all ${s===l?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"bg-gray-700/50 text-gray-300 hover:bg-gray-700"}`,children:[i.jsx("span",{className:"text-lg font-semibold",children:l}),i.jsx("span",{className:"text-xs block text-gray-400",children:a("common.min")})]},l))}),i.jsx("button",{onClick:()=>{o(),e()},className:"w-full mt-4 py-3 rounded-xl bg-gray-700/50 text-gray-300 hover:bg-gray-700 transition-colors",children:a("player.turnOff")})]})}):null}function bl(){var g;const{t}=ee(),{bookId:e}=_r(),{togglePlay:s,seek:n,skipTime:r}=Zn(),{book:o,currentEpisode:a,isPlaying:l,currentTime:d,duration:c,isLoading:u,error:h,sleepTimerMinutes:v,sleepTimerRemaining:m,loadBook:f,setEpisode:p,setSleepTimer:x,cancelSleepTimer:N,syncHistory:j}=qe(),[E,T]=b.useState(!1),[F,D]=b.useState(!1);b.useEffect(()=>{e&&f(e)},[e,f]);const $=S=>{const P=parseFloat(S.target.value);n(P)},J=async S=>{await p(S)},_=()=>{a>0&&J(a-1)},I=()=>{var P;const S=((P=o==null?void 0:o.episodes)==null?void 0:P.length)||0;a<S-1&&J(a+1)},Q=async()=>{await j()};if(u)return i.jsx("div",{className:"h-screen flex justify-center items-center bg-gray-900 overflow-hidden",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})});if(h||!o)return i.jsxs("div",{className:"h-screen flex flex-col items-center justify-center gap-4 bg-gray-900 px-4 overflow-hidden",children:[i.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded-lg",children:h||t("player.bookNotFound")}),i.jsxs(ae,{to:"/",className:"flex items-center gap-2 text-indigo-400 hover:text-indigo-300",children:[i.jsx(an,{className:"w-5 h-5"}),t("player.backToLibrary")]})]});const k=o.episodes||[],R=c>0?d/c*100:0;return i.jsxs("div",{className:"h-screen bg-gradient-to-b from-gray-900 via-gray-900 to-gray-800 flex flex-col overflow-hidden",children:[i.jsxs("header",{className:"flex items-center justify-between p-4 relative z-10",children:[i.jsx(ae,{to:"/",className:"p-2 rounded-full hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",onClick:Q,children:i.jsx(an,{})}),i.jsx("h1",{className:"text-white font-medium truncate max-w-[50%] text-center",children:o.title}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("button",{onClick:()=>D(!0),className:`p-2 rounded-full hover:bg-gray-800 transition-colors relative ${v!==null?"text-indigo-400":"text-gray-400 hover:text-white"}`,title:t("player.sleepTimer"),children:[i.jsx(cr,{}),v!==null&&i.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-indigo-500 rounded-full animate-pulse"})]}),i.jsx("button",{onClick:()=>T(!0),className:"p-2 rounded-full hover:bg-gray-800 text-gray-400 hover:text-white transition-colors",children:i.jsx(pl,{})})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:[i.jsx(ml,{coverUrl:Le(o.id,!!o.cover_url),isPlaying:l,title:o.title}),i.jsxs("div",{className:"mt-16 text-center",children:[i.jsx("h2",{className:"text-xl font-bold text-white",children:o.title}),o.author&&i.jsx("p",{className:"text-gray-400 mt-1",children:o.author}),i.jsx("p",{className:"text-indigo-400 text-xlg mt-2",children:t("player.episodeOf",{current:a+1,total:k.length})}),i.jsx("p",{className:"text-gray-500 text-sm",children:((g=k[a])==null?void 0:g.title)||`${t("common.episode")} ${a+1}`})]})]}),i.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-lg rounded-t-3xl px-6 pb-8 pt-6 shadow-2xl",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"relative h-2 bg-gray-700 rounded-full overflow-hidden",children:[i.jsx("div",{className:"absolute h-full bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full transition-all duration-150",style:{width:`${R}%`}}),i.jsx("input",{type:"range",min:0,max:c||100,value:d,onChange:$,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),i.jsxs("div",{className:"flex justify-between mt-2 text-sm text-gray-400",children:[i.jsx("span",{children:He(d)}),i.jsx("span",{children:He(c)})]})]}),i.jsxs("div",{className:"flex items-center justify-center gap-4",children:[i.jsx("button",{onClick:_,disabled:a===0,className:"p-3 rounded-full text-gray-400 hover:text-white hover:bg-gray-700/50 transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:i.jsx(dl,{})}),i.jsx("button",{onClick:()=>r(-10),className:"p-3 rounded-full text-gray-300 hover:text-white hover:bg-gray-700/50 transition-all",children:i.jsx(hl,{})}),i.jsx("button",{onClick:s,className:"w-16 h-16 min-w-[4rem] min-h-[4rem] aspect-square flex-shrink-0 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white flex items-center justify-center shadow-lg shadow-indigo-500/30 hover:shadow-indigo-500/50 transition-all active:scale-95",children:l?i.jsx(ar,{}):i.jsx(as,{})}),i.jsx("button",{onClick:()=>r(30),className:"p-3 rounded-full text-gray-300 hover:text-white hover:bg-gray-700/50 transition-all",children:i.jsx(fl,{})}),i.jsx("button",{onClick:I,disabled:a===k.length-1,className:"p-3 rounded-full text-gray-400 hover:text-white hover:bg-gray-700/50 transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:i.jsx(ul,{})})]})]}),i.jsx(gl,{isOpen:E,onClose:()=>T(!1),episodes:k,currentEpisode:a,onSelectEpisode:J,bookTitle:o.title}),i.jsx(yl,{isOpen:F,onClose:()=>D(!1),activeTimer:v,remainingTime:m,onSetTimer:x,onCancelTimer:N}),i.jsx("style",{children:`
        @keyframes spin-slow {
          from {
            transform: rotate(0deg);
          }
          to {
            transform: rotate(360deg);
          }
        }
        .animate-spin-slow {
          animation: spin-slow 8s linear infinite;
        }
        @keyframes slide-up {
          from {
            transform: translateY(100%);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
      `})]})}function ln(t){var R;const{locations:e,onClose:s,onError:n}=t,{t:r}=ee(),[o,a]=b.useState(""),[l,d]=b.useState(""),[c,u]=b.useState(!1),[h,v]=b.useState(!1),[m,f]=b.useState(!1),[p,x]=b.useState(!1),[N,j]=b.useState(null),[E,T]=b.useState(!1),F="bookIds"in t&&t.bookIds!==void 0,D=F?r("admin.storage.bulkMoveTitle",{count:t.bookCount}):r("admin.storage.moveTitle",{title:(R=t.book)==null?void 0:R.title}),$=g=>{if(g===0)return"0 B";const S=["B","KB","MB","GB","TB"];let P=0;for(;g>=1024&&P<S.length-1;)g/=1024,P++;return`${g.toFixed(1)} ${S[P]}`},J=()=>{if(c)return l;const g=e.find(S=>S.id===o);return(g==null?void 0:g.basePath)||""},_=async(g="")=>{var S,P;T(!0);try{const H=await V.get("/admin/storage/browse-path",{params:{path:g}});j(H.data.data),x(!0)}catch(H){n(((P=(S=H.response)==null?void 0:S.data)==null?void 0:P.error)||r("admin.storage.browseFailed"))}finally{T(!1)}},I=g=>{d(g),x(!1)},Q=async()=>{var S,P;const g=J();if(!g){n(r("admin.storage.selectDestination"));return}f(!0);try{if(F){const H=await V.post("/admin/storage/move/bulk",{audiobookIds:t.bookIds,destinationPath:g,stopOnError:h});t.onBulkMoveStart(H.data.data.batchId)}else await V.post("/admin/storage/move",{audiobookId:t.book.id,destinationPath:g}),t.onMoveComplete()}catch(H){n(((P=(S=H.response)==null?void 0:S.data)==null?void 0:P.error)||r("admin.storage.moveFailed")),f(!1)}},k=F?e.filter(g=>g.isAvailable):e.filter(g=>{var S;return g.isAvailable&&g.basePath!==((S=t.book)==null?void 0:S.storagePath)});return i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:D}),i.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),!F&&t.book&&i.jsxs("div",{className:"mb-4 p-3 bg-gray-700 rounded-lg",children:[i.jsx("p",{className:"text-white font-medium",children:t.book.title}),i.jsxs("p",{className:"text-sm text-gray-400",children:[t.book.author||r("common.unknown"),"  ",$(t.book.sizeBytes)]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r("admin.storage.currentLocation"),": ",t.book.storagePath]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:r("admin.storage.selectDestination")}),k.length>0&&i.jsx("div",{className:"space-y-2 mb-4",children:k.map(g=>i.jsxs("label",{className:`flex items-center p-3 rounded-lg cursor-pointer ${!c&&o===g.id?"bg-indigo-900/50 border border-indigo-500":"bg-gray-700 border border-transparent hover:border-gray-500"}`,children:[i.jsx("input",{type:"radio",name:"location",checked:!c&&o===g.id,onChange:()=>{a(g.id),u(!1)},className:"sr-only"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white font-medium",children:g.name}),i.jsxs("span",{className:"text-xs text-green-400",children:[$(g.freeSpaceBytes)," ",r("admin.storage.free")]})]}),i.jsx("p",{className:"text-sm text-gray-400",children:g.basePath})]}),i.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${!c&&o===g.id?"border-indigo-500 bg-indigo-500":"border-gray-500"}`,children:!c&&o===g.id&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]},g.id))}),i.jsxs("label",{className:`flex items-start p-3 rounded-lg cursor-pointer ${c?"bg-indigo-900/50 border border-indigo-500":"bg-gray-700 border border-transparent hover:border-gray-500"}`,children:[i.jsx("input",{type:"radio",name:"location",checked:c,onChange:()=>u(!0),className:"sr-only"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"text-white font-medium",children:r("admin.storage.customPath")}),c&&i.jsxs("div",{className:"mt-2 flex gap-2",children:[i.jsx("input",{type:"text",value:l,onChange:g=>d(g.target.value),placeholder:"G:\\AudioBooks",className:"flex-1 px-3 py-2 bg-gray-600 border border-gray-500 rounded text-white text-sm"}),i.jsx("button",{type:"button",onClick:()=>_(l||""),disabled:E,className:"px-3 py-2 bg-gray-600 hover:bg-gray-500 rounded text-sm text-white",children:r("admin.storage.browse")})]})]}),i.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center mt-0.5 ${c?"border-indigo-500 bg-indigo-500":"border-gray-500"}`,children:c&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]})]}),F&&i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:h,onChange:g=>v(g.target.checked),className:"w-4 h-4 text-indigo-600 rounded"}),i.jsx("span",{className:"text-sm text-gray-300",children:r("admin.storage.stopOnError")})]})]}),p&&N&&i.jsxs("div",{className:"mt-4 p-3 bg-gray-700 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-sm text-gray-300 truncate flex-1",children:N.currentPath||r("admin.storage.drives")}),i.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-white ml-2",children:""})]}),i.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-1",children:[N.parentPath&&i.jsxs("button",{onClick:()=>_(N.parentPath),className:"w-full text-left px-2 py-1.5 hover:bg-gray-600 rounded text-sm text-gray-300 flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 17l-5-5m0 0l5-5m-5 5h12"})}),".."]}),N.items.map(g=>i.jsxs("button",{onClick:()=>g.type==="directory"||g.type==="drive"?_(g.path):I(g.path),onDoubleClick:()=>I(g.path),className:"w-full text-left px-2 py-1.5 hover:bg-gray-600 rounded text-sm text-white flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),g.name]},g.path))]}),i.jsx("div",{className:"mt-2 flex justify-end",children:i.jsx("button",{onClick:()=>I(N.currentPath),className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 rounded text-sm text-white",children:r("admin.storage.selectThisFolder")})})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-700",children:[i.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded text-white",children:r("common.cancel")}),i.jsx("button",{onClick:Q,disabled:m||!o&&!l||c&&!l,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded text-white disabled:opacity-50",children:r(m?"admin.storage.moving":"admin.storage.startMove")})]})]})})}function vl({batchId:t,onComplete:e,onError:s}){const{t:n}=ee(),[r,o]=b.useState(null),[a,l]=b.useState(!1);b.useEffect(()=>{let m;const f=async()=>{var p,x;try{const j=(await V.get(`/admin/storage/move/progress/${t}`)).data.data;o(j),["completed","completed_with_errors","cancelled","stopped_on_error"].includes(j.status)&&(clearInterval(m),setTimeout(()=>{e()},2e3))}catch(N){s(((x=(p=N.response)==null?void 0:p.data)==null?void 0:x.error)||n("admin.storage.progressFailed"))}};return f(),m=setInterval(f,1e3),()=>{clearInterval(m)}},[t,e,s,n]);const d=async()=>{var m,f;l(!0);try{await V.post(`/admin/storage/move/cancel/${t}`)}catch(p){s(((f=(m=p.response)==null?void 0:m.data)==null?void 0:f.error)||n("admin.storage.cancelFailed")),l(!1)}},c=()=>{if(!r)return 0;const m=r.completedBooks+r.failedBooks;return Math.round(m/r.totalBooks*100)},u=()=>{if(!r)return"text-gray-400";switch(r.status){case"completed":return"text-green-400";case"completed_with_errors":return"text-yellow-400";case"cancelled":case"stopped_on_error":return"text-red-400";default:return"text-indigo-400"}},h=()=>{if(!r)return n("admin.storage.loading");switch(r.status){case"pending":return n("admin.storage.statusPending");case"in_progress":return n("admin.storage.statusInProgress");case"completed":return n("admin.storage.statusCompleted");case"completed_with_errors":return n("admin.storage.statusCompletedWithErrors");case"cancelled":return n("admin.storage.statusCancelled");case"stopped_on_error":return n("admin.storage.statusStoppedOnError");default:return r.status}},v=(r==null?void 0:r.status)==="pending"||(r==null?void 0:r.status)==="in_progress";return i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:n("admin.storage.bulkMoveProgress")}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[i.jsx("span",{className:"text-gray-300",children:r?`${r.completedBooks+r.failedBooks} / ${r.totalBooks}`:"..."}),i.jsx("span",{className:u(),children:h()})]}),i.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${c()}%`}})})]}),(r==null?void 0:r.currentBook)&&v&&i.jsxs("div",{className:"mb-4 p-3 bg-gray-700 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-gray-400",children:[n("admin.storage.currentlyMoving"),":"]}),i.jsx("p",{className:"text-white font-medium truncate",children:r.currentBook.title})]}),r&&i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"text-center p-3 bg-gray-700 rounded-lg",children:[i.jsx("p",{className:"text-2xl font-bold text-green-400",children:r.completedBooks}),i.jsx("p",{className:"text-sm text-gray-400",children:n("admin.storage.successful")})]}),i.jsxs("div",{className:"text-center p-3 bg-gray-700 rounded-lg",children:[i.jsx("p",{className:"text-2xl font-bold text-red-400",children:r.failedBooks}),i.jsx("p",{className:"text-sm text-gray-400",children:n("admin.storage.failed")})]})]}),r&&r.errors.length>0&&i.jsxs("div",{className:"mb-4",children:[i.jsxs("p",{className:"text-sm font-medium text-red-400 mb-2",children:[n("admin.storage.errors",{count:r.errors.length}),":"]}),i.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1 text-sm",children:r.errors.map((m,f)=>i.jsxs("div",{className:"p-2 bg-red-900/30 rounded text-red-300",children:[i.jsxs("span",{className:"font-medium",children:[m.title,":"]})," ",m.error]},f))})]}),i.jsx("div",{className:"flex justify-end gap-3",children:v?i.jsx("button",{onClick:d,disabled:a,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded text-white disabled:opacity-50",children:n(a?"admin.storage.cancelling":"admin.storage.cancel")}):i.jsx("button",{onClick:e,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded text-white",children:n("common.close")})})]})})}function wl({onError:t,onSuccess:e}){const{t:s}=ee(),[n,r]=b.useState([]),[o,a]=b.useState([]),[l,d]=b.useState(!0),[c,u]=b.useState(new Set),[h,v]=b.useState(!1),[m,f]=b.useState(""),[p,x]=b.useState(""),[N,j]=b.useState(!1),[E,T]=b.useState(null),[F,D]=b.useState(!1),[$,J]=b.useState(null);b.useEffect(()=>{_()},[]);const _=async()=>{var C,K;d(!0);try{const[q,M]=await Promise.all([V.get("/admin/storage/locations"),V.get("/admin/storage/audiobooks")]);r(q.data.data.locations),a(M.data.data.audiobooks)}catch(q){t(((K=(C=q.response)==null?void 0:C.data)==null?void 0:K.error)||s("admin.storage.loadFailed"))}finally{d(!1)}},I=C=>{if(C===0)return"0 B";const K=["B","KB","MB","GB","TB"];let q=0;for(;C>=1024&&q<K.length-1;)C/=1024,q++;return`${C.toFixed(1)} ${K[q]}`},Q=async C=>{var K,q;if(C.preventDefault(),!(!m.trim()||!p.trim())){j(!0);try{await V.post("/admin/storage/locations",{name:m.trim(),basePath:p.trim()}),e(s("admin.storage.locationAdded")),f(""),x(""),v(!1),_()}catch(M){t(((q=(K=M.response)==null?void 0:K.data)==null?void 0:q.error)||s("admin.storage.addFailed"))}finally{j(!1)}}},k=async C=>{var K,q;if(confirm(s("admin.storage.deleteConfirm")))try{await V.delete(`/admin/storage/locations/${C}`),e(s("admin.storage.locationDeleted")),_()}catch(M){t(((q=(K=M.response)==null?void 0:K.data)==null?void 0:q.error)||s("admin.storage.deleteFailed"))}},R=()=>{c.size===o.length?u(new Set):u(new Set(o.map(C=>C.id)))},g=C=>{const K=new Set(c);K.has(C)?K.delete(C):K.add(C),u(K)},S=()=>{T(null),D(!1),u(new Set),_(),e(s("admin.storage.moveComplete"))},P=C=>{D(!1),J(C)},H=()=>{J(null),u(new Set),_(),e(s("admin.storage.moveComplete"))};return l?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:s("admin.storage.title")}),i.jsx("button",{onClick:()=>v(!h),className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 rounded text-sm text-white",children:s(h?"common.cancel":"admin.storage.addLocation")})]}),h&&i.jsxs("form",{onSubmit:Q,className:"mb-4 p-4 bg-gray-700 rounded-lg space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:s("admin.storage.locationName")}),i.jsx("input",{type:"text",value:m,onChange:C=>f(C.target.value),placeholder:"External Drive",className:"w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded text-white",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:s("admin.storage.basePath")}),i.jsx("input",{type:"text",value:p,onChange:C=>x(C.target.value),placeholder:"G:\\AudioBooks",className:"w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded text-white",required:!0})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"submit",disabled:N,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded text-white disabled:opacity-50",children:s(N?"common.loading":"admin.storage.addLocation")})})]}),n.length===0?i.jsx("p",{className:"text-gray-400",children:s("admin.storage.noLocations")}):i.jsx("div",{className:"space-y-3",children:n.map(C=>i.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded-lg p-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"font-medium text-white",children:C.name}),i.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${C.isAvailable?"bg-green-900 text-green-300":"bg-red-900 text-red-300"}`,children:C.isAvailable?s("admin.storage.online"):s("admin.storage.offline")})]}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:C.basePath}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s("admin.storage.freeSpace"),": ",I(C.freeSpaceBytes)," / ",I(C.totalSpaceBytes),"  ",s("admin.storage.booksCount",{count:C.bookCount})]})]}),C.id!=="default"&&i.jsx("button",{onClick:()=>k(C.id),className:"p-2 text-red-400 hover:text-red-300 hover:bg-gray-600 rounded",title:s("common.delete"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},C.id))})]}),i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:s("admin.storage.audiobooksTitle",{count:o.length})}),c.size>0&&i.jsx("button",{onClick:()=>D(!0),className:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 rounded text-sm text-white",children:s("admin.storage.moveSelected",{count:c.size})})]}),o.length===0?i.jsx("p",{className:"text-gray-400",children:s("admin.storage.noAudiobooks")}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-700 rounded",children:[i.jsx("input",{type:"checkbox",checked:c.size===o.length&&o.length>0,onChange:R,className:"w-4 h-4 text-indigo-600 rounded"}),i.jsx("span",{className:"text-sm text-gray-300",children:s("admin.storage.selectAll")})]}),o.map(C=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-700 rounded-lg hover:bg-gray-650",children:[i.jsx("input",{type:"checkbox",checked:c.has(C.id),onChange:()=>g(C.id),className:"w-4 h-4 text-indigo-600 rounded"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-medium text-white truncate",children:C.title}),i.jsxs("p",{className:"text-sm text-gray-400 truncate",children:[C.author||s("common.unknown"),"  ",I(C.sizeBytes)]}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:C.storagePath})]}),i.jsxs("button",{onClick:()=>T(C),className:"px-3 py-1.5 bg-gray-600 hover:bg-gray-500 rounded text-sm text-white flex items-center gap-1",title:s("admin.storage.move"),children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),s("admin.storage.move")]})]},C.id))]})]}),E&&i.jsx(ln,{book:E,locations:n,onClose:()=>T(null),onMoveComplete:S,onError:t}),F&&i.jsx(ln,{bookIds:Array.from(c),bookCount:c.size,locations:n,onClose:()=>D(!1),onBulkMoveStart:P,onError:t}),$&&i.jsx(vl,{batchId:$,onComplete:H,onError:t})]})}function jl(){const{t}=ee(),[e,s]=b.useState("books"),[n,r]=b.useState([]),[o,a]=b.useState([]),[l,d]=b.useState(!0),[c,u]=b.useState(""),[h,v]=b.useState(""),[m,f]=b.useState(1),[p,x]=b.useState(1),[N,j]=b.useState(0),E=20,[T,F]=b.useState([]),[D,$]=b.useState(null),[J,_]=b.useState(""),[I,Q]=b.useState(""),[k,R]=b.useState("adult"),[g,S]=b.useState(!1),[P,H]=b.useState([]),[C,K]=b.useState(""),[q,M]=b.useState([]),[G,ne]=b.useState(!1),[W,ie]=b.useState(null),[ue,je]=b.useState(""),[ls,Nt]=b.useState(""),[cs,kt]=b.useState(""),[ds,St]=b.useState(""),[Je,Ge]=b.useState("adult"),[Ne,Et]=b.useState([]),[Ye,Qe]=b.useState(null),[us,Xe]=b.useState(null),[hs,fs]=b.useState(!1),[ps,ms]=b.useState(!1),Ct=b.useRef(null),Ot=b.useRef(null),Lt=b.useRef(null),fe=b.useRef(null),Tt="admin-books-scroll";b.useEffect(()=>{e==="books"?Ae(m):e==="users"&&gr()},[e,m]),b.useEffect(()=>{if(e==="books"&&!l&&n.length>0){const w=sessionStorage.getItem(Tt);w&&(window.scrollTo(0,parseInt(w,10)),sessionStorage.removeItem(Tt))}},[e,l,n]);const mr=()=>{sessionStorage.setItem(Tt,String(window.scrollY))};b.useEffect(()=>{const w=T.map((O,L)=>({title:O.name.replace(/\.[^/.]+$/,"")||`${t("common.episode")} ${L+1}`,duration:0}));H(w)},[T,t]);const Ae=async(w=1)=>{var O,L;d(!0);try{const A=await V.get(`/admin/books?page=${w}&limit=${E}`);r(A.data.data.books),x(A.data.data.totalPages),j(A.data.data.total)}catch(A){u(((L=(O=A.response)==null?void 0:O.data)==null?void 0:L.error)||t("admin.books.loadFailed"))}finally{d(!1)}},gr=async()=>{var w,O;d(!0);try{const L=await V.get("/admin/users");a(L.data.data)}catch(L){u(((O=(w=L.response)==null?void 0:w.data)==null?void 0:O.error)||t("admin.users.loadFailed"))}finally{d(!1)}},xr=w=>{const O=w.target.files;if(O){const L=Array.from(O).filter(A=>A.type.startsWith("audio/")||A.name.endsWith(".mp3")||A.name.endsWith(".m4b")||A.name.endsWith(".m4a")).sort((A,z)=>A.name.localeCompare(z.name,void 0,{numeric:!0}));F(L)}},yr=w=>{const O=w.target.files;if(O){const L=Array.from(O).filter(A=>A.type.startsWith("audio/")||A.name.endsWith(".mp3")||A.name.endsWith(".m4b")||A.name.endsWith(".m4a")).sort((A,z)=>A.name.localeCompare(z.name,void 0,{numeric:!0}));F(L)}},br=w=>{var L;const O=(L=w.target.files)==null?void 0:L[0];O&&O.type.startsWith("image/")&&$(O)},vr=(w,O)=>{H(L=>{const A=[...L];return A[w]={...A[w],title:O},A})},wr=async w=>{var L,A;if(w.preventDefault(),T.length===0){u(t("admin.upload.selectAudioFiles"));return}S(!0),u(""),v("");const O=new FormData;O.append("title",J),O.append("author",I),O.append("bookType",k),D&&O.append("cover",D),T.forEach(z=>{O.append("audioFiles",z)}),O.append("chapters",JSON.stringify(P));try{await V.post("/admin/books",O,{headers:{"Content-Type":"multipart/form-data"}}),v(t("admin.upload.uploadSuccess")),jr(),s("books"),Ae(m)}catch(z){u(((A=(L=z.response)==null?void 0:L.data)==null?void 0:A.error)||t("admin.upload.uploadFailed"))}finally{S(!1)}},jr=()=>{F([]),$(null),_(""),Q(""),H([]),Ct.current&&(Ct.current.value=""),Ot.current&&(Ot.current.value="")},Nr=w=>{const O=w.target.files;if(O){const L=Array.from(O).filter(A=>A.type.startsWith("audio/")||A.name.endsWith(".mp3")||A.name.endsWith(".m4b")||A.name.endsWith(".m4a")).sort((A,z)=>A.name.localeCompare(z.name,void 0,{numeric:!0}));M(L)}},kr=async()=>{var L,A;if(!C||q.length===0){u(t("admin.addEpisodes.selectBookAndFiles"));return}ne(!0),u(""),v("");const w=new FormData;q.forEach(z=>{w.append("audioFiles",z)});const O=q.map((z,re)=>({title:z.name.replace(/\.[^/.]+$/,"")||`${t("common.episode")} ${re+1}`,duration:0}));w.append("chapters",JSON.stringify(O));try{await V.post(`/admin/books/${C}/episodes`,w,{headers:{"Content-Type":"multipart/form-data"}}),v(t("admin.addEpisodes.addSuccess")),M([]),K(""),Lt.current&&(Lt.current.value=""),Ae(m)}catch(z){u(((A=(L=z.response)==null?void 0:L.data)==null?void 0:A.error)||t("admin.addEpisodes.addFailed"))}finally{ne(!1)}},Sr=async w=>{var O,L;if(confirm(t("admin.books.deleteConfirm")))try{await V.delete(`/admin/books/${w}`),r(n.filter(A=>A.id!==w)),v(t("admin.books.bookDeleted"))}catch(A){u(((L=(O=A.response)==null?void 0:O.data)==null?void 0:L.error)||t("common.delete"))}},Er=async(w,O)=>{var A,z;const L=O==="admin"?"user":"admin";try{await V.put(`/admin/users/${w}/role`,{role:L}),a(o.map(re=>re.id===w?{...re,role:L}:re)),v(t("admin.users.roleUpdated",{role:L}))}catch(re){u(((z=(A=re.response)==null?void 0:A.data)==null?void 0:z.error)||t("admin.users.loadFailed"))}},Cr=async(w,O)=>{var L,A;try{await V.put(`/admin/books/${w}`,{is_published:!O}),r(n.map(z=>z.id===w?{...z,is_published:!O}:z)),v(t(O?"admin.books.bookUnpublished":"admin.books.bookPublished"))}catch(z){u(((A=(L=z.response)==null?void 0:L.data)==null?void 0:A.error)||t("admin.books.loadFailed"))}},Or=async w=>{var O,L;mr();try{const z=(await V.get(`/books/${w.id}`)).data.data;ie(z),je(z.title),Nt(z.author||""),kt(z.narrator||""),St(z.description||""),Ge(z.book_type),Et((z.episodes||[]).map(re=>({title:re.title,duration:re.duration})))}catch(A){u(((L=(O=A.response)==null?void 0:O.data)==null?void 0:L.error)||t("admin.books.loadFailed"))}},Ze=()=>{ie(null),je(""),Nt(""),kt(""),St(""),Ge("adult"),Et([]),Qe(null),Xe(null),fe.current&&(fe.current.value="")},Lr=(w,O)=>{Et(L=>{const A=[...L];return A[w]={...A[w],title:O},A})},Tr=w=>{var L;const O=(L=w.target.files)==null?void 0:L[0];O&&O.type.startsWith("image/")&&(Qe(O),Xe(URL.createObjectURL(O)))},Rr=async()=>{var O,L;if(!W||!Ye)return;ms(!0),u("");const w=new FormData;w.append("cover",Ye);try{const A=await V.put(`/admin/books/${W.id}/cover`,w,{headers:{"Content-Type":"multipart/form-data"}});ie({...W,cover_url:A.data.data.cover_url}),Qe(null),Xe(null),fe.current&&(fe.current.value=""),v(t("admin.editBook.coverUpdateSuccess")),Ae(m)}catch(A){u(((L=(O=A.response)==null?void 0:O.data)==null?void 0:L.error)||t("admin.editBook.coverUpdateFailed"))}finally{ms(!1)}},Pr=async()=>{var w,O;if(W){fs(!0),u("");try{const L={};ue!==W.title&&(L.title=ue);const A=ls||null;A!==(W.author||null)&&(L.author=A);const z=cs||null;z!==(W.narrator||null)&&(L.narrator=z);const re=ds||null;re!==(W.description||null)&&(L.description=re),Je!==W.book_type&&(L.book_type=Je);const Rt=W.episodes||[];let gs=!1;for(let pe=0;pe<Ne.length&&pe<Rt.length;pe++)if(Ne[pe].title!==Rt[pe].title){gs=!0;break}if(gs){const pe=Rt.map((xs,Ar)=>{var ys;return{...xs,title:((ys=Ne[Ar])==null?void 0:ys.title)||xs.title}});L.episodes=pe}if(Object.keys(L).length===0){Ze();return}await V.put(`/admin/books/${W.id}`,L),v(t("admin.editBook.updateSuccess")),Ze(),Ae(m)}catch(L){u(((O=(w=L.response)==null?void 0:w.data)==null?void 0:O.error)||t("admin.books.loadFailed"))}finally{fs(!1)}}};return i.jsxs("div",{className:"min-h-screen",children:[i.jsx(wt,{children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(ae,{to:"/",className:"text-gray-400 hover:text-white p-2 -ml-2",title:t("admin.backToLibrary"),children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),i.jsx("h1",{className:"text-2xl font-bold text-indigo-400",children:t("admin.title")})]})})}),i.jsxs(jt,{className:"pt-[85px]",children:[i.jsx("div",{className:"flex gap-2 border-b border-gray-700 mb-6",children:["books","users","upload","storage"].map(w=>i.jsx("button",{onClick:()=>s(w),className:`px-4 py-2 font-medium capitalize ${e===w?"text-indigo-400 border-b-2 border-indigo-400":"text-gray-400 hover:text-white"}`,children:t(`admin.tabs.${w}`)},w))}),c&&i.jsxs("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded mb-4",children:[c,i.jsx("button",{onClick:()=>u(""),className:"float-right text-red-300 hover:text-white",children:""})]}),h&&i.jsxs("div",{className:"bg-green-900/50 border border-green-500 text-green-200 px-4 py-3 rounded mb-4",children:[h,i.jsx("button",{onClick:()=>v(""),className:"float-right text-green-300 hover:text-white",children:""})]}),e==="upload"&&i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:t("admin.upload.title")}),i.jsxs("form",{onSubmit:wr,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300",children:t("admin.upload.audioFiles")}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:t("admin.upload.selectFolder")}),i.jsx("input",{ref:Ct,type:"file",webkitdirectory:"",directory:"",multiple:!0,onChange:xr,className:"block w-full text-gray-400 text-sm"})]}),i.jsx("div",{className:"text-gray-500 self-end pb-2",children:t("common.or")}),i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:t("admin.upload.selectFiles")}),i.jsx("input",{ref:Ot,type:"file",accept:"audio/*",multiple:!0,onChange:yr,className:"block w-full text-gray-400 text-sm"})]})]}),T.length>0&&i.jsx("p",{className:"text-sm text-indigo-400",children:t("admin.upload.filesSelected",{count:T.length})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.coverImage")}),i.jsx("input",{type:"file",accept:"image/*",onChange:br,className:"block w-full text-gray-400 text-sm"}),D&&i.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[i.jsx("img",{src:URL.createObjectURL(D),alt:"Cover preview",className:"w-16 h-16 object-cover rounded"}),i.jsx("button",{type:"button",onClick:()=>$(null),className:"text-red-400 hover:text-red-300 text-sm",children:t("common.remove")})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.titleRequired")}),i.jsx("input",{type:"text",value:J,onChange:w=>_(w.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.author")}),i.jsx("input",{type:"text",value:I,onChange:w=>Q(w.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("admin.upload.contentType")}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"adult",checked:k==="adult",onChange:()=>R("adult"),className:"mr-2"}),i.jsx("span",{className:"text-gray-300",children:t("admin.upload.adult")})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"kids",checked:k==="kids",onChange:()=>R("kids"),className:"mr-2"}),i.jsx("span",{className:"text-gray-300",children:t("admin.upload.kids")})]})]})]}),P.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("admin.upload.episodes",{count:P.length})}),i.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 bg-gray-700 rounded p-2",children:P.map((w,O)=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-gray-500 text-sm w-8",children:[O+1,"."]}),i.jsx("input",{type:"text",value:w.title,onChange:L=>vr(O,L.target.value),className:"flex-1 px-2 py-1 bg-gray-600 border border-gray-500 rounded text-white text-sm"})]},O))})]}),i.jsx("button",{type:"submit",disabled:g||T.length===0,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded text-white disabled:opacity-50",children:t(g?"admin.upload.uploading":"admin.upload.uploadBook")})]})]}),i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:t("admin.addEpisodes.title")}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.addEpisodes.selectBook")}),i.jsxs("select",{value:C,onChange:w=>K(w.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white",children:[i.jsx("option",{value:"",children:t("admin.addEpisodes.selectBookPlaceholder")}),n.map(w=>i.jsx("option",{value:w.id,children:t("admin.addEpisodes.bookOption",{title:w.title,count:w.episode_count})},w.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.addEpisodes.audioFilesToAdd")}),i.jsx("input",{ref:Lt,type:"file",accept:"audio/*",multiple:!0,onChange:Nr,className:"block w-full text-gray-400 text-sm"}),q.length>0&&i.jsx("p",{className:"text-sm text-indigo-400 mt-1",children:t("admin.addEpisodes.filesSelected",{count:q.length})})]}),i.jsx("button",{onClick:kr,disabled:G||!C||q.length===0,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded text-white disabled:opacity-50",children:t(G?"admin.addEpisodes.adding":"admin.addEpisodes.addEpisodes")})]})]})]}),e==="books"&&i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:t("admin.books.title",{count:N})}),l?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):n.length===0?i.jsx("p",{className:"text-gray-400",children:t("admin.books.noBooks")}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"space-y-3",children:n.map(w=>i.jsxs("div",{className:`flex items-center justify-between bg-gray-800 rounded-lg p-4 ${w.is_published?"":"opacity-60"}`,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[w.cover_url?i.jsx("img",{src:Le(w.id,!!w.cover_url)||"",alt:w.title,className:"w-12 h-12 object-cover rounded"}):i.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded flex items-center justify-center",children:""}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-medium text-white",children:w.title}),!w.is_published&&i.jsx("span",{className:"px-2 py-0.5 bg-gray-600 text-gray-300 text-xs rounded",children:t("admin.books.draft")})]}),i.jsxs("p",{className:"text-sm text-gray-400",children:[w.author||t("common.unknown"),"  ",w.episode_count," ",t("common.episodes")," "," ",i.jsx("span",{className:w.book_type==="kids"?"text-green-400":"text-yellow-400",children:w.book_type==="kids"?t("categories.kids"):t("categories.adult")})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>Cr(w.id,w.is_published),className:`w-9 h-9 flex items-center justify-center rounded ${w.is_published?"bg-gray-600 hover:bg-gray-500":"bg-green-600 hover:bg-green-700"}`,title:w.is_published?t("admin.books.unpublishBook"):t("admin.books.publishBook"),children:w.is_published?i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),i.jsx("button",{onClick:()=>Or(w),className:"w-9 h-9 flex items-center justify-center bg-indigo-600 hover:bg-indigo-700 rounded",title:t("admin.books.editBook"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),i.jsx("button",{onClick:()=>Sr(w.id),className:"w-9 h-9 flex items-center justify-center bg-red-600 hover:bg-red-700 rounded",title:t("admin.books.deleteBook"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},w.id))}),p>1&&i.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[i.jsx("button",{onClick:()=>f(1),disabled:m===1,className:"w-10 h-10 flex items-center justify-center bg-gray-700 hover:bg-gray-600 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:t("admin.pagination.firstPage"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),i.jsx("button",{onClick:()=>f(w=>Math.max(1,w-1)),disabled:m===1,className:"w-10 h-10 flex items-center justify-center bg-gray-700 hover:bg-gray-600 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:t("admin.pagination.previousPage"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),i.jsx("div",{className:"flex items-center gap-1 px-2",children:Array.from({length:Math.min(5,p)},(w,O)=>{let L;return p<=5||m<=3?L=O+1:m>=p-2?L=p-4+O:L=m-2+O,i.jsx("button",{onClick:()=>f(L),className:`w-10 h-10 rounded text-sm ${m===L?"bg-indigo-600 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"}`,children:L},L)})}),i.jsx("button",{onClick:()=>f(w=>Math.min(p,w+1)),disabled:m===p,className:"w-10 h-10 flex items-center justify-center bg-gray-700 hover:bg-gray-600 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:t("admin.pagination.nextPage"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),i.jsx("button",{onClick:()=>f(p),disabled:m===p,className:"w-10 h-10 flex items-center justify-center bg-gray-700 hover:bg-gray-600 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:t("admin.pagination.lastPage"),children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),p>1&&i.jsx("div",{className:"mt-3 text-center text-sm text-gray-500",children:t("admin.pagination.showing",{start:(m-1)*E+1,end:Math.min(m*E,N),total:N})})]})]}),e==="users"&&i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:t("admin.users.title",{count:o.length})}),l?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"})}):o.length===0?i.jsx("p",{className:"text-gray-400",children:t("admin.users.noUsers")}):i.jsx("div",{className:"space-y-3",children:o.map(w=>i.jsxs("div",{className:"flex items-center justify-between bg-gray-800 rounded-lg p-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-white",children:w.display_name||w.email}),i.jsxs("p",{className:"text-sm text-gray-400",children:[w.email," "," ",i.jsx("span",{className:w.user_type==="kid"?"text-green-400":"text-blue-400",children:w.user_type})," ",""," ",i.jsx("span",{className:w.role==="admin"?"text-yellow-400":"text-gray-400",children:w.role})]})]}),i.jsx("button",{onClick:()=>Er(w.id,w.role),className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm",children:w.role==="admin"?t("admin.users.revokeAdmin"):t("admin.users.makeAdmin")})]},w.id))})]}),e==="storage"&&i.jsx(wl,{onError:w=>u(w),onSuccess:w=>v(w)})]}),W&&i.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:t("admin.editBook.title")}),i.jsx("button",{onClick:Ze,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.titleRequired")}),i.jsx("input",{type:"text",value:ue,onChange:w=>je(w.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.author")}),i.jsx("input",{type:"text",value:ls,onChange:w=>Nt(w.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.narrator")}),i.jsx("input",{type:"text",value:cs,onChange:w=>kt(w.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:t("admin.upload.description")}),i.jsx("textarea",{value:ds,onChange:w=>St(w.target.value),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("admin.upload.contentType")}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"adult",checked:Je==="adult",onChange:()=>Ge("adult"),className:"mr-2"}),i.jsx("span",{className:"text-gray-300",children:t("admin.upload.adult")})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"kids",checked:Je==="kids",onChange:()=>Ge("kids"),className:"mr-2"}),i.jsx("span",{className:"text-gray-300",children:t("admin.upload.kids")})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("admin.editBook.coverImage")}),i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-24 h-24 bg-gray-700 rounded overflow-hidden flex-shrink-0",children:us?i.jsx("img",{src:us,alt:t("admin.editBook.newCoverPreview"),className:"w-full h-full object-cover"}):W.cover_url?i.jsx("img",{src:Le(W.id,!!W.cover_url)||"",alt:W.title,className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-3xl",children:""})}),i.jsxs("div",{className:"flex-1 space-y-2",children:[i.jsx("input",{ref:fe,type:"file",accept:"image/*",onChange:Tr,className:"block w-full text-gray-400 text-sm"}),Ye&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:Rr,disabled:ps,className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm text-white disabled:opacity-50",children:t(ps?"admin.upload.uploading":"admin.editBook.uploadCover")}),i.jsx("button",{type:"button",onClick:()=>{Qe(null),Xe(null),fe.current&&(fe.current.value="")},className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 rounded text-sm text-white",children:t("common.cancel")})]}),i.jsx("p",{className:"text-xs text-gray-500",children:t(Ye?"admin.editBook.uploadCoverHint":"admin.editBook.selectImageHint")})]})]})]}),Ne.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t("admin.upload.episodes",{count:Ne.length})}),i.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 bg-gray-700 rounded p-2",children:Ne.map((w,O)=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-gray-500 text-sm w-8",children:[O+1,"."]}),i.jsx("input",{type:"text",value:w.title,onChange:L=>Lr(O,L.target.value),className:"flex-1 px-2 py-1 bg-gray-600 border border-gray-500 rounded text-white text-sm"})]},O))})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[i.jsx("button",{onClick:Ze,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded text-white",children:t("common.cancel")}),i.jsx("button",{onClick:Pr,disabled:hs||!ue,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded text-white disabled:opacity-50",children:t(hs?"admin.editBook.saving":"admin.editBook.saveChanges")})]})]})]})})]})}function Nl(){const{t}=ee(),[e,s]=b.useState([]),[n,r]=b.useState(!0),[o,a]=b.useState(""),{bookId:l}=qe(),d=!!l;b.useEffect(()=>{c()},[]);const c=async()=>{var u,h;try{const m=(await V.get("/history/with-books")).data.data;s(m)}catch(v){a(((h=(u=v.response)==null?void 0:u.data)==null?void 0:h.error)||t("history.loadFailed"))}finally{r(!1)}};return i.jsxs("div",{className:`min-h-screen ${d?"pb-40":"pb-24"}`,children:[i.jsx(wt,{children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center gap-4",children:i.jsx("h1",{className:"text-2xl font-bold text-white",children:t("history.title")})})}),i.jsx(jt,{className:"pt-[85px]",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):o?i.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded",children:o}):e.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-gray-400 text-lg mb-2",children:t("history.noHistory")}),i.jsx("p",{className:"text-gray-500 text-sm",children:t("history.noHistoryHint")}),i.jsx(ae,{to:"/",className:"mt-6 inline-block px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded",children:t("history.browseBooks")})]}):i.jsx("div",{className:"space-y-4",children:e.map(u=>{const h=u.book;return i.jsxs(ae,{to:`/player/${h.id}`,className:"flex gap-4 bg-gray-800 rounded-xl p-4 hover:bg-gray-750 hover:ring-2 hover:ring-indigo-500/50 transition-all group",children:[i.jsxs("div",{className:"relative flex-shrink-0 w-20 h-20 sm:w-24 sm:h-24 rounded-lg overflow-hidden bg-gray-700",children:[h.cover_url?i.jsx("img",{src:Le(h.id,!!h.cover_url)||"",alt:h.title,className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx("span",{className:"text-3xl",children:""})}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center",children:i.jsx(as,{className:"w-5 h-5"})})})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-semibold text-white text-lg truncate group-hover:text-indigo-400 transition-colors",children:h.title}),h.author&&i.jsx("p",{className:"text-sm text-gray-400 truncate",children:h.author}),i.jsxs("div",{className:"mt-2",children:[i.jsx("p",{className:"text-sm text-indigo-400",children:t("history.episodeOf",{current:u.episode_index+1,total:h.episode_count})}),i.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[t("common.position"),": ",He(u.current_time_seconds)]})]}),i.jsx("p",{className:"mt-2 text-xs text-gray-500",children:ir(u.last_played_at)})]})]},u.id)})})})]})}/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Sl=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),cn=t=>{const e=Sl(t);return e.charAt(0).toUpperCase()+e.slice(1)},dr=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),El=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cl={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:r="",children:o,iconNode:a,...l},d)=>b.createElement("svg",{ref:d,...Cl,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:dr("lucide",r),...!o&&!El(l)&&{"aria-hidden":"true"},...l},[...a.map(([c,u])=>b.createElement(c,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=(t,e)=>{const s=b.forwardRef(({className:n,...r},o)=>b.createElement(Ol,{ref:o,iconNode:e,className:dr(`lucide-${kl(cn(t))}`,`lucide-${t}`,n),...r}));return s.displayName=cn(t),s};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Tl=he("chevron-right",Ll);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pl=he("clock",Rl);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Fl=he("globe",Al);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Bl=he("house",Il);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],_l=he("log-out",$l);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ml=he("mail",Dl);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hl=he("settings",Ul);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Vl=he("shield",zl);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ur=he("user",Kl);function Wl(){const{t,i18n:e}=ee(),{user:s,logout:n}=oe(),r=ut(),o=()=>{n(),r("/login")},a=d=>{e.changeLanguage(d)},l=()=>s!=null&&s.display_name?s.display_name.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2):s!=null&&s.email?s.email[0].toUpperCase():"U";return i.jsxs("div",{className:"min-h-screen pb-24",children:[i.jsx(wt,{children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:i.jsx("h1",{className:"text-2xl font-bold text-white",children:t("profile.title")})})}),i.jsxs(jt,{className:"pt-[85px]",children:[i.jsx("div",{className:"bg-gray-800 rounded-2xl p-6 mb-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xl font-bold",children:l()}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-xl font-semibold text-white truncate",children:(s==null?void 0:s.display_name)||t("profile.user")}),i.jsxs("p",{className:"text-sm text-gray-400 truncate flex items-center gap-1",children:[i.jsx(Ml,{className:"w-4 h-4"}),s==null?void 0:s.email]})]})]})}),i.jsxs("div",{className:"bg-gray-800 rounded-2xl overflow-hidden mb-6",children:[i.jsx("div",{className:"px-4 py-3 border-b border-gray-700",children:i.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase tracking-wider",children:t("profile.accountInfo")})}),i.jsxs("div",{className:"divide-y divide-gray-700",children:[i.jsxs("div",{className:"px-4 py-4 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-700 flex items-center justify-center text-gray-400",children:i.jsx(ur,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm text-gray-400",children:t("profile.accountType")}),i.jsx("p",{className:"text-white capitalize",children:(s==null?void 0:s.user_type)||t("profile.standard")})]})]}),i.jsxs("div",{className:"px-4 py-4 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-700 flex items-center justify-center text-gray-400",children:i.jsx(Vl,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm text-gray-400",children:t("profile.role")}),i.jsx("p",{className:"text-white capitalize",children:(s==null?void 0:s.role)||t("profile.user")})]})]}),(s==null?void 0:s.role)==="admin"&&i.jsxs(ae,{to:"/admin",className:"px-4 py-4 flex items-center gap-3 hover:bg-gray-700/50 transition-colors",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-600/20 flex items-center justify-center text-indigo-400",children:i.jsx(Hl,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-white",children:t("profile.adminDashboard")}),i.jsx("p",{className:"text-sm text-gray-400",children:t("profile.adminDashboardDesc")})]}),i.jsx(Tl,{className:"w-5 h-5 text-gray-500"})]})]})]}),i.jsxs("div",{className:"bg-gray-800 rounded-2xl overflow-hidden mb-6",children:[i.jsx("div",{className:"px-4 py-3 border-b border-gray-700",children:i.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase tracking-wider",children:t("profile.settings")})}),i.jsx("div",{className:"divide-y divide-gray-700",children:i.jsxs("div",{className:"px-4 py-4 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-700 flex items-center justify-center text-gray-400",children:i.jsx(Fl,{className:"w-5 h-5"})}),i.jsx("div",{className:"flex-1",children:i.jsx("p",{className:"text-sm text-gray-400",children:t("profile.language")})}),i.jsxs("div",{className:"flex items-center bg-gray-700 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>a("en"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${e.language==="en"?"bg-indigo-600 text-white shadow-sm":"text-gray-400 hover:text-white"}`,children:"EN"}),i.jsx("button",{onClick:()=>a("zh"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${e.language==="zh"?"bg-indigo-600 text-white shadow-sm":"text-gray-400 hover:text-white"}`,children:""})]})]})})]}),i.jsxs("div",{className:"bg-gray-800 rounded-2xl overflow-hidden",children:[i.jsx("div",{className:"px-4 py-3 border-b border-gray-700",children:i.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase tracking-wider",children:t("profile.actions","Actions")})}),i.jsxs("button",{onClick:o,className:"w-full px-4 py-4 flex items-center gap-3 hover:bg-gray-700/50 transition-colors text-left",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-600/20 flex items-center justify-center text-red-400",children:i.jsx(_l,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-red-400 font-medium",children:t("auth.signOut")}),i.jsx("p",{className:"text-sm text-gray-500",children:t("auth.signOutDescription")})]})]})]}),i.jsx("p",{className:"text-center text-xs text-gray-600 mt-8",children:t("common.version")})]})]})}function ql(){const{t}=ee(),e=mn(),s=[{path:"/history",icon:i.jsx(Pl,{className:"w-6 h-6"}),labelKey:"nav.history"},{path:"/",icon:i.jsx(Bl,{className:"w-6 h-6"}),labelKey:"nav.library"},{path:"/profile",icon:i.jsx(ur,{className:"w-6 h-6"}),labelKey:"nav.profile"}];return["/admin","/login","/register","/player"].some(o=>e.pathname.startsWith(o))?null:i.jsxs("nav",{className:"fixed bottom-0 left-0 right-0 bg-gray-900/95 backdrop-blur-sm border-t border-gray-800 z-50",children:[i.jsx("div",{className:"max-w-md mx-auto px-4",children:i.jsx("div",{className:"flex items-center justify-around py-2",children:s.map(o=>{const a=e.pathname===o.path;return i.jsxs(ae,{to:o.path,className:`flex flex-col items-center gap-1 px-4 py-2 rounded-xl transition-all duration-150
                  ${a?"text-indigo-400":"text-gray-400 hover:text-gray-200 active:scale-95"}`,children:[i.jsxs("div",{className:`relative ${a?"transform scale-110":""}`,children:[o.icon,a&&i.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-indigo-400 rounded-full"})]}),i.jsx("span",{className:"text-xs font-medium",children:t(o.labelKey)})]},o.path)})})}),i.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}function Jl(){const{t}=ee(),e=ut(),s=mn(),{togglePlay:n}=Zn(),{bookId:r,book:o,currentEpisode:a,isPlaying:l,currentTime:d,duration:c}=qe();if(!r||!o||["/admin","/login","/register","/player"].some(p=>s.pathname.startsWith(p)))return null;const v=c>0?d/c*100:0,m=o.episodes||[],f=()=>{e(`/player/${r}`)};return i.jsxs("div",{className:"fixed bottom-[75px] left-0 right-0 z-40 bg-gray-800/95 backdrop-blur-sm border-t border-gray-700 safe-area-bottom",children:[i.jsx("div",{className:"h-1 bg-gray-700",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-150",style:{width:`${v}%`}})}),i.jsx("div",{className:"max-w-7xl mx-auto px-4",children:i.jsxs("div",{className:"flex items-center gap-3 py-3",children:[i.jsx("button",{onClick:f,className:"flex-shrink-0 w-12 h-12 rounded-lg overflow-hidden bg-gray-700 hover:ring-2 hover:ring-indigo-500/50 transition-all",children:o.cover_url?i.jsx("img",{src:Le(o.id,!!o.cover_url)||"",alt:o.title,className:"w-full h-full object-cover"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-indigo-600 to-purple-700",children:i.jsx("span",{className:"text-lg",children:""})})}),i.jsxs("button",{onClick:f,className:"flex-1 min-w-0 text-left",children:[i.jsx("p",{className:"text-white font-medium truncate text-sm",children:o.title}),i.jsxs("p",{className:"text-gray-400 text-xs truncate",children:[t("common.episodeAbbr")," ",a+1,"/",m.length,"  ",He(d)]})]}),i.jsx("button",{onClick:p=>{p.stopPropagation(),n()},className:"flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white flex items-center justify-center shadow-lg hover:shadow-indigo-500/30 transition-all active:scale-95",children:l?i.jsx(ar,{className:"w-6 h-6"}):i.jsx(as,{className:"w-6 h-6"})})]})}),i.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}function nt({children:t}){const{isAuthenticated:e}=oe();return e?i.jsx(i.Fragment,{children:t}):i.jsx(Ht,{to:"/login"})}function Gl({children:t}){const{user:e,isAuthenticated:s}=oe();return s?(e==null?void 0:e.role)!=="admin"?i.jsx(Ht,{to:"/"}):i.jsx(i.Fragment,{children:t}):i.jsx(Ht,{to:"/login"})}function Yl(){return i.jsx(ja,{children:i.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[i.jsxs(Dr,{children:[i.jsx(ge,{path:"/login",element:i.jsx(ll,{})}),i.jsx(ge,{path:"/register",element:i.jsx(cl,{})}),i.jsx(ge,{path:"/",element:i.jsx(nt,{children:i.jsx(al,{})})}),i.jsx(ge,{path:"/player/:bookId",element:i.jsx(nt,{children:i.jsx(bl,{})})}),i.jsx(ge,{path:"/history",element:i.jsx(nt,{children:i.jsx(Nl,{})})}),i.jsx(ge,{path:"/profile",element:i.jsx(nt,{children:i.jsx(Wl,{})})}),i.jsx(ge,{path:"/admin",element:i.jsx(Gl,{children:i.jsx(jl,{})})})]}),i.jsx(Jl,{}),i.jsx(ql,{})]})})}const{slice:Ql,forEach:Xl}=[];function Zl(t){return Xl.call(Ql.call(arguments,1),e=>{if(e)for(const s in e)t[s]===void 0&&(t[s]=e[s])}),t}function ec(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(s=>s.test(t))}const dn=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,tc=function(t,e){const n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},r=encodeURIComponent(e);let o=`${t}=${r}`;if(n.maxAge>0){const a=n.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");o+=`; Max-Age=${Math.floor(a)}`}if(n.domain){if(!dn.test(n.domain))throw new TypeError("option domain is invalid");o+=`; Domain=${n.domain}`}if(n.path){if(!dn.test(n.path))throw new TypeError("option path is invalid");o+=`; Path=${n.path}`}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+=`; Expires=${n.expires.toUTCString()}`}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n.partitioned&&(o+="; Partitioned"),o},un={create(t,e,s,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};s&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+s*60*1e3)),n&&(r.domain=n),document.cookie=tc(t,e,r)},read(t){const e=`${t}=`,s=document.cookie.split(";");for(let n=0;n<s.length;n++){let r=s[n];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return r.substring(e.length,r.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var sc={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return un.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:s,cookieMinutes:n,cookieDomain:r,cookieOptions:o}=e;s&&typeof document<"u"&&un.create(s,t,n,r,o)}},nc={name:"querystring",lookup(t){var n;let{lookupQuerystring:e}=t,s;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&((n=window.location.hash)==null?void 0:n.indexOf("?"))>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const a=r.substring(1).split("&");for(let l=0;l<a.length;l++){const d=a[l].indexOf("=");d>0&&a[l].substring(0,d)===e&&(s=a[l].substring(d+1))}}return s}},rc={name:"hash",lookup(t){var r;let{lookupHash:e,lookupFromHashIndex:s}=t,n;if(typeof window<"u"){const{hash:o}=window.location;if(o&&o.length>2){const a=o.substring(1);if(e){const l=a.split("&");for(let d=0;d<l.length;d++){const c=l[d].indexOf("=");c>0&&l[d].substring(0,c)===e&&(n=l[d].substring(c+1))}}if(n)return n;if(!n&&s>-1){const l=o.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?(r=l[typeof s=="number"?s:0])==null?void 0:r.replace("/",""):void 0}}}return n}};let Se=null;const hn=()=>{if(Se!==null)return Se;try{if(Se=typeof window<"u"&&window.localStorage!==null,!Se)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Se=!1}return Se};var oc={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&hn())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:s}=e;s&&hn()&&window.localStorage.setItem(s,t)}};let Ee=null;const fn=()=>{if(Ee!==null)return Ee;try{if(Ee=typeof window<"u"&&window.sessionStorage!==null,!Ee)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{Ee=!1}return Ee};var ic={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&fn())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:s}=e;s&&fn()&&window.sessionStorage.setItem(s,t)}},ac={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:s,userLanguage:n,language:r}=navigator;if(s)for(let o=0;o<s.length;o++)e.push(s[o]);n&&e.push(n),r&&e.push(r)}return e.length>0?e:void 0}},lc={name:"htmlTag",lookup(t){let{htmlTag:e}=t,s;const n=e||(typeof document<"u"?document.documentElement:null);return n&&typeof n.getAttribute=="function"&&(s=n.getAttribute("lang")),s}},cc={name:"path",lookup(t){var r;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const s=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(s)?(r=s[typeof e=="number"?e:0])==null?void 0:r.replace("/",""):void 0}},dc={name:"subdomain",lookup(t){var r,o;let{lookupFromSubdomainIndex:e}=t;const s=typeof e=="number"?e+1:1,n=typeof window<"u"&&((o=(r=window.location)==null?void 0:r.hostname)==null?void 0:o.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(n)return n[s]}};let hr=!1;try{document.cookie,hr=!0}catch{}const fr=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];hr||fr.splice(1,1);const uc=()=>({order:fr,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class pr{constructor(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,s)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=Zl(s,this.options||{},uc()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=r=>r.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(sc),this.addDetector(nc),this.addDetector(oc),this.addDetector(ic),this.addDetector(ac),this.addDetector(lc),this.addDetector(cc),this.addDetector(dc),this.addDetector(rc)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,s=[];return e.forEach(n=>{if(this.detectors[n]){let r=this.detectors[n].lookup(this.options);r&&typeof r=="string"&&(r=[r]),r&&(s=s.concat(r))}}),s=s.filter(n=>n!=null&&!ec(n)).map(n=>this.options.convertDetectedLanguage(n)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?s:s.length>0?s[0]:null}cacheUserLanguage(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;s&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||s.forEach(n=>{this.detectors[n]&&this.detectors[n].cacheUserLanguage(e,this.options)}))}}pr.type="languageDetector";const hc={appName:"Audiobook Player",loading:"Loading...",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",remove:"Remove",or:"or",unknown:"Unknown",episode:"Episode",episodes:"episodes",episodeAbbr:"Ep.",of:"of",min:"min",position:"Position",version:"Audiobooks v1.0.0",close:"Close"},fc={signIn:"Sign in",signOut:"Sign Out",signInToAccount:"Sign in to your account",signingIn:"Signing in...",createAccount:"Create account",creatingAccount:"Creating account...",createYourAccount:"Create your account",email:"Email",emailPlaceholder:"you@example.com",password:"Password",passwordPlaceholder:"",displayName:"Display Name",displayNamePlaceholder:"Your name",accountType:"Account Type",adult:"Adult",kid:"Kid",noAccount:"Don't have an account?",hasAccount:"Already have an account?",register:"Register",loginFailed:"Login failed",registrationFailed:"Registration failed",signOutDescription:"Sign out of your account"},pc={history:"History",library:"Library",profile:"Profile"},mc={title:"Audiobooks",noBooks:"No audiobooks available yet.",noCategoryBooks:"No {{category}} audiobooks available.",uploadFirst:"Upload your first book",showingBooks:"Showing {{start}}-{{end}} of {{total}} books"},gc={title:"Listening History",noHistory:"No listening history yet",noHistoryHint:"Start listening to an audiobook and it will appear here.",browseBooks:"Browse Audiobooks",episodeOf:"Episode {{current}} of {{total}}",loadFailed:"Failed to load history"},xc={sleepTimer:"Sleep Timer",backToLibrary:"Back to library",bookNotFound:"Book not found",episodeOf:"Episode {{current}} of {{total}}",timerActive:"Timer active",cancelTimer:"Cancel Timer",turnOff:"Turn Off"},yc={title:"Profile",user:"User",accountInfo:"Account Info",accountType:"Account Type",role:"Role",standard:"Standard",settings:"Settings",language:"Language",actions:"Actions",adminDashboard:"Admin Dashboard",adminDashboardDesc:"Manage books and users"},bc={title:"Admin Dashboard",backToLibrary:"Back to library",tabs:{books:"books",users:"users",upload:"upload",storage:"storage"},upload:{title:"Upload New Audiobook",audioFiles:"Audio Files",selectFolder:"Select Folder",selectFiles:"Select Files",filesSelected:"{{count}} audio file(s) selected",coverImage:"Cover Image (optional)",titleRequired:"Title *",author:"Author",narrator:"Narrator",description:"Description",contentType:"Content Type",adult:"Adult",kids:"Kids",episodes:"Episodes ({{count}})",uploading:"Uploading...",uploadBook:"Upload Book",uploadSuccess:"Book uploaded successfully!",uploadFailed:"Upload failed",selectAudioFiles:"Please select audio files"},addEpisodes:{title:"Add Episodes to Existing Book",selectBook:"Select Book",selectBookPlaceholder:"-- Select a book --",bookOption:"{{title}} ({{count}} episodes)",audioFilesToAdd:"Audio Files to Add",filesSelected:"{{count}} file(s) selected",adding:"Adding...",addEpisodes:"Add Episodes",selectBookAndFiles:"Please select a book and audio files",addSuccess:"Episodes added successfully!",addFailed:"Failed to add episodes"},books:{title:"Books ({{count}})",noBooks:"No books yet. Upload your first book!",draft:"Draft",unpublishBook:"Unpublish book",publishBook:"Publish book",editBook:"Edit book",deleteBook:"Delete book",deleteConfirm:"Are you sure you want to delete this book?",bookDeleted:"Book deleted",bookPublished:"Book published",bookUnpublished:"Book unpublished",loadFailed:"Failed to load books"},users:{title:"Users ({{count}})",noUsers:"No users found.",revokeAdmin:"Revoke Admin",makeAdmin:"Make Admin",roleUpdated:"User role updated to {{role}}",loadFailed:"Failed to load users"},editBook:{title:"Edit Book",coverImage:"Cover Image",newCoverPreview:"New cover preview",uploadCover:"Upload Cover",uploadCoverHint:"Click 'Upload Cover' to save the new image",selectImageHint:"Select an image file to change the cover",saveChanges:"Save Changes",saving:"Saving...",updateSuccess:"Book updated successfully!",coverUpdateSuccess:"Cover updated successfully!",coverUpdateFailed:"Failed to upload cover"},pagination:{firstPage:"First page",previousPage:"Previous page",nextPage:"Next page",lastPage:"Last page",showing:"Showing {{start}}-{{end}} of {{total}} books"},storage:{title:"Storage Locations",addLocation:"Add Location",locationName:"Location Name",basePath:"Base Path",freeSpace:"Free",online:"Online",offline:"Offline",booksCount:"{{count}} books",noLocations:"No storage locations configured.",locationAdded:"Storage location added successfully!",locationDeleted:"Storage location deleted.",addFailed:"Failed to add storage location",deleteFailed:"Failed to delete storage location",deleteConfirm:"Are you sure you want to delete this storage location?",loadFailed:"Failed to load storage data",audiobooksTitle:"Audiobooks ({{count}})",noAudiobooks:"No audiobooks found.",selectAll:"Select All",moveSelected:"Move Selected ({{count}})",move:"Move",moveTitle:"Move: {{title}}",bulkMoveTitle:"Move {{count}} Books",currentLocation:"Current location",selectDestination:"Select Destination",customPath:"Custom Path",browse:"Browse",browseFailed:"Failed to browse path",drives:"Drives",selectThisFolder:"Select This Folder",stopOnError:"Stop on first error",moving:"Moving...",startMove:"Start Move",moveFailed:"Move operation failed",moveComplete:"Move completed successfully!",free:"free",bulkMoveProgress:"Bulk Move Progress",currentlyMoving:"Currently moving",successful:"Successful",failed:"Failed",errors:"{{count}} Errors",cancel:"Cancel",cancelling:"Cancelling...",cancelFailed:"Failed to cancel operation",progressFailed:"Failed to get progress",statusPending:"Pending",statusInProgress:"In Progress",statusCompleted:"Completed",statusCompletedWithErrors:"Completed with Errors",statusCancelled:"Cancelled",statusStoppedOnError:"Stopped on Error",loading:"Loading..."}},vc={all:"All",adult:"Adult",kids:"Kids"},wc={common:hc,auth:fc,nav:pc,home:mc,history:gc,player:xc,profile:yc,admin:bc,categories:vc},jc={appName:"",loading:"...",save:"",cancel:"",delete:"",edit:"",remove:"",or:"",unknown:"",episode:"",episodes:"",episodeAbbr:"",of:"/",min:"",position:"",version:" v1.0.0",close:""},Nc={signIn:"",signOut:"",signInToAccount:"",signingIn:"...",createAccount:"",creatingAccount:"...",createYourAccount:"",email:"",emailPlaceholder:"you@example.com",password:"",passwordPlaceholder:"",displayName:"",displayNamePlaceholder:"",accountType:"",adult:"",kid:"",noAccount:"",hasAccount:"",register:"",loginFailed:"",registrationFailed:"",signOutDescription:""},kc={history:"",library:"",profile:""},Sc={title:"",noBooks:"",noCategoryBooks:"{{category}}",uploadFirst:"",showingBooks:" {{start}}-{{end}}  {{total}} "},Ec={title:"",noHistory:"",noHistoryHint:"",browseBooks:"",episodeOf:" {{current}}  {{total}} ",loadFailed:""},Cc={sleepTimer:"",backToLibrary:"",bookNotFound:"",episodeOf:" {{current}}  {{total}} ",timerActive:"",cancelTimer:"",turnOff:""},Oc={title:"",user:"",accountInfo:"",accountType:"",role:"",standard:"",settings:"",language:"",actions:"",adminDashboard:"",adminDashboardDesc:""},Lc={title:"",backToLibrary:"",tabs:{books:"",users:"",upload:"",storage:""},upload:{title:"",audioFiles:"",selectFolder:"",selectFiles:"",filesSelected:" {{count}} ",coverImage:"",titleRequired:" *",author:"",narrator:"",description:"",contentType:"",adult:"",kids:"",episodes:" ({{count}})",uploading:"...",uploadBook:"",uploadSuccess:"",uploadFailed:"",selectAudioFiles:""},addEpisodes:{title:"",selectBook:"",selectBookPlaceholder:"--  --",bookOption:"{{title}} ({{count}} )",audioFilesToAdd:"",filesSelected:" {{count}} ",adding:"...",addEpisodes:"",selectBookAndFiles:"",addSuccess:"",addFailed:""},books:{title:" ({{count}})",noBooks:"",draft:"",unpublishBook:"",publishBook:"",editBook:"",deleteBook:"",deleteConfirm:"",bookDeleted:"",bookPublished:"",bookUnpublished:"",loadFailed:""},users:{title:" ({{count}})",noUsers:"",revokeAdmin:"",makeAdmin:"",roleUpdated:" {{role}}",loadFailed:""},editBook:{title:"",coverImage:"",newCoverPreview:"",uploadCover:"",uploadCoverHint:"",selectImageHint:"",saveChanges:"",saving:"...",updateSuccess:"",coverUpdateSuccess:"",coverUpdateFailed:""},pagination:{firstPage:"",previousPage:"",nextPage:"",lastPage:"",showing:" {{start}}-{{end}}  {{total}} "},storage:{title:"",addLocation:"",locationName:"",basePath:"",freeSpace:"",online:"",offline:"",booksCount:"{{count}} ",noLocations:"",locationAdded:"",locationDeleted:"",addFailed:"",deleteFailed:"",deleteConfirm:"",loadFailed:"",audiobooksTitle:" ({{count}})",noAudiobooks:"",selectAll:"",moveSelected:" ({{count}})",move:"",moveTitle:"{{title}}",bulkMoveTitle:" {{count}} ",currentLocation:"",selectDestination:"",customPath:"",browse:"",browseFailed:"",drives:"",selectThisFolder:"",stopOnError:"",moving:"...",startMove:"",moveFailed:"",moveComplete:"",free:"",bulkMoveProgress:"",currentlyMoving:"",successful:"",failed:"",errors:"{{count}} ",cancel:"",cancelling:"...",cancelFailed:"",progressFailed:"",statusPending:"",statusInProgress:"",statusCompleted:"",statusCompletedWithErrors:"",statusCancelled:"",statusStoppedOnError:"",loading:"..."}},Tc={all:"",adult:"",kids:""},Rc={common:jc,auth:Nc,nav:kc,home:Sc,history:Ec,player:Cc,profile:Oc,admin:Lc,categories:Tc};Z.use(pr).use(Za).init({resources:{en:{translation:wc},zh:{translation:Rc}},fallbackLng:"en",supportedLngs:["en","zh"],detection:{order:["navigator","htmlTag","localStorage","cookie"],caches:["localStorage"],convertDetectedLanguage:t=>t.startsWith("zh")?"zh":t.split("-")[0]},interpolation:{escapeValue:!1}});const Pc="/audiobookshelf/".replace(/\/$/,"")||"/";zt.createRoot(document.getElementById("root")).render(i.jsx(pn.StrictMode,{children:i.jsx(Mr,{basename:Pc,children:i.jsx(Yl,{})})}));
//# sourceMappingURL=index-uSUIpwwF.js.map
